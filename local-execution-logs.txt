
(base) C:\Users\yogit>conda activate dbconnect

(dbconnect) C:\Users\yogit>databricks-connect configure
The current configuration is:
* Databricks Host: https://adb-2694257014171907.7.azuredatabricks.net/
* Databricks Token: dapi9f9bdf4ac33e754dae344ff3cd41f5d8-3
* Cluster ID: 0322-160933-herd201
* Org ID: 2694257014171907
* Port: 15001
Set new config values (leave input empty to accept default):
Databricks Host [https://adb-2694257014171907.7.azuredatabricks.net/]: https://adb-79201576775287.7.azuredatabricks.net/

*** IMPORTANT: For AAD token users, please leave this empty and set AAD token via spark conf, spark.databricks.service.token

Databricks Token [dapi9f9bdf4ac33e754dae344ff3cd41f5d8-3]: dapi3680e458d9ad976634673997814e1d14-3

*** IMPORTANT: please ensure that your cluster has:
- Databricks Runtime version of DBR 5.1+
- Python version same as your local Python (i.e., 2.7 or 3.5)
- the Spark conf `spark.databricks.service.server.enabled true` set

Cluster ID (e.g., 0921-001415-jelly628) [0322-160933-herd201]: 0323-192449-niece309
Org ID (Azure-only, see ?o=orgId in URL) [2694257014171907]: 79201576775287
Port [15001]: 15001

Updated configuration in C:\Users\yogit/.databricks-connect
* Spark jar dir: c:\users\yogit\anaconda3\envs\dbconnect\lib\site-packages\pyspark/jars
* Spark home: c:\users\yogit\anaconda3\envs\dbconnect\lib\site-packages\pyspark
* Run `pip install -U databricks-connect` to install updates
* Run `pyspark` to launch a Python shell
* Run `spark-shell` to launch a Scala shell
* Run `databricks-connect test` to test connectivity

(dbconnect) C:\Users\yogit>cd ..

(dbconnect) C:\Users>cd ..

(dbconnect) C:\>cd ..

(dbconnect) C:\>cd Step_Five_Pipeline_Orchestration

(dbconnect) C:\Step_Five_Pipeline_Orchestration>cd src

(dbconnect) C:\Step_Five_Pipeline_Orchestration\src>python etldriver.py
21/03/23 15:38:31 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 15:38:31 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 15:38:35 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
21/03/23 15:38:46 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 15:38:57,203 :: INFO :: main :: 78 :: Processing raw csv
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:34:51.505|1           |2020-08-05 05:30:00|0E-14            |75.30254839137037|100     |75.35916738004924|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:40:52.586|2           |2020-08-05 05:30:00|0E-14            |77.20874619466693|100     |78.90918015646369|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:50:04.681|3           |2020-08-05 05:30:00|0E-14            |77.15973273251218|100     |77.33204694110470|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:57:46.343|4           |2020-08-05 05:30:00|0E-14            |79.29977331004093|100     |80.08399307353596|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:06:50.886|5           |2020-08-05 05:30:00|0E-14            |77.86349512170780|100     |78.30821537434917|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:11:43.839|6           |2020-08-05 05:30:00|0E-14            |78.74799689143143|100     |80.32905299746953|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:17:02.044|7           |2020-08-05 05:30:00|0E-14            |77.16837620945849|100     |77.97598027909252|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:23:58.216|8           |2020-08-05 05:30:00|0E-14            |78.06551496692607|100     |78.80516026628197|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:31:40.057|9           |2020-08-05 05:30:00|0E-14            |76.69653634240801|100     |78.56942375735030|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 06:37:21.581|10          |2020-08-05 05:30:00|79.19488165597565|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:45:27.205|11          |2020-08-05 05:30:00|0E-14            |75.10473622642823|100     |77.09656190920616|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:54:06.198|12          |2020-08-05 05:30:00|0E-14            |74.52147919052219|100     |75.66916329143558|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:03:24.882|13          |2020-08-05 05:30:00|0E-14            |75.16876091805237|100     |76.70697764844876|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:12:54.259|14          |2020-08-05 05:30:00|0E-14            |74.56633254759171|100     |74.62137517521543|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:19:55.013|15          |2020-08-05 05:30:00|0E-14            |74.49803365619901|100     |76.47591167094056|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:27:34.304|16          |2020-08-05 05:30:00|0E-14            |75.22889133048018|100     |76.14368647113133|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:35:18.534|17          |2020-08-05 05:30:00|0E-14            |76.62791946609745|100     |76.99149298587172|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:42:42.976|18          |2020-08-05 05:30:00|0E-14            |77.09466818643507|100     |78.15967343099572|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:51:08.791|19          |2020-08-05 05:30:00|0E-14            |78.33536506091860|100     |79.39139072379258|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 07:56:13.086|20          |2020-08-05 05:30:00|76.49092501585646|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 15:39:07,066 :: INFO :: main :: 78 :: Processing raw json(0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|0E-14            |76.10016521142818|100     |77.96479759087470|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|0E-14            |75.44372945251948|100     |75.94452858561046|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|0E-14            |78.84798564828422|100     |80.69114407667608|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:53:09.803|4           |2020-08-05 05:30:00|0E-14            |74.98336890552693|100     |76.16256530811053|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:00:10.866|5           |2020-08-05 05:30:00|0E-14            |76.71408448666702|100     |77.85512785142082|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:05:24.344|6           |2020-08-05 05:30:00|0E-14            |76.78900747031288|100     |77.79982571852163|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:13:59.224|7           |2020-08-05 05:30:00|0E-14            |76.37099394549293|100     |76.94631910510188|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:21:43.76 |8           |2020-08-05 05:30:00|0E-14            |77.32601214334609|100     |77.65017757988643|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:30:33.547|9           |2020-08-05 05:30:00|0E-14            |77.11395059665263|100     |77.52985832434904|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:45:54.754|11          |2020-08-05 05:30:00|0E-14            |77.69893211260312|100     |79.18604684163077|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:54:34.696|12          |2020-08-05 05:30:00|0E-14            |75.09529363658093|100     |75.83132049866276|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:02:08.291|13          |2020-08-05 05:30:00|0E-14            |77.76547178321442|100     |79.41345232512326|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:11:36.644|14          |2020-08-05 05:30:00|0E-14            |76.39994032672179|100     |76.83733213626446|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:19:53.959|15          |2020-08-05 05:30:00|0E-14            |79.09882325040374|100     |79.83007081928720|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:29:25.432|16          |2020-08-05 05:30:00|0E-14            |74.72294172166815|100     |76.05085199350985|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:34:40.415|17          |2020-08-05 05:30:00|0E-14            |78.06235033524703|100     |78.36705025855920|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:41:23.633|18          |2020-08-05 05:30:00|0E-14            |78.71683328488820|100     |80.45610125569267|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:50:54.911|19          |2020-08-05 05:30:00|0E-14            |79.17169989748359|100     |80.14798230305898|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 15:39:10,375 :: INFO :: main :: 78 :: Processing eod trade0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 09:09:24.38 |30          |2020-08-05 05:30:00|75.87925515076047|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
only showing top 3 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 15:39:23,613 :: INFO :: main :: 78 :: Processing eod quote0 + 1) / 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |bid_pr           |bid_size|ask_pr           |ask_size|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|76.10016521142818|100     |77.96479759087470|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|75.44372945251948|100     |75.94452858561046|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|78.84798564828422|100     |80.69114407667608|100     |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
only showing top 3 rows

root
 |-- trade_dt: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- event_tm: timestamp (nullable = true)
 |-- event_seq_nb: integer (nullable = true)
 |-- arrival_tm: timestamp (nullable = true)
 |-- bid_pr: decimal(17,14) (nullable = true)
 |-- bid_size: integer (nullable = true)
 |-- ask_pr: decimal(17,14) (nullable = true)
 |-- ask_size: integer (nullable = true)

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 15:39:28,612 :: INFO :: main :: 78 :: Processing analytical_quote/ 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 15:39:34 WARN HintErrorLogger: Count not find relation 'prev_temp_last_trade' specified in hint 'BROADCAST(prev_temp_last_trade)'.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2020-08-06>                                                         (0 + 1) / 1]
2021-03-23 15:39:38,455 :: INFO :: <module> :: 108 :: Updating the job status in the POSTGRES Table
2021-03-23 15:39:38,463 :: INFO :: <module> :: 112 :: Updating the job status
Job ID Assigned: 8
2021-03-23 15:39:38,577 :: ERROR :: get_db_connection :: 94 :: Error while connecting to PostgreSQL could not translate host name "postgresdbyn.postgres.database.azure.com" to address: Unknown host

Job ID Assigned: 9
2021-03-23 15:39:38,595 :: ERROR :: get_db_connection :: 94 :: Error while connecting to PostgreSQL could not translate host name "postgresdbyn.postgres.database.azure.com" to address: Unknown host

Traceback (most recent call last):
  File "etldriver.py", line 113, in <module>
    tracker.update_job_status("success")
  File "C:\Step_Five_Pipeline_Orchestration\src\Tracker.py", line 37, in update_job_status
    cursor = conn.cursor()
AttributeError: 'NoneType' object has no attribute 'cursor'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "etldriver.py", line 115, in <module>
    tracker.update_job_status("failed")
  File "C:\Step_Five_Pipeline_Orchestration\src\Tracker.py", line 37, in update_job_status
    cursor = conn.cursor()
AttributeError: 'NoneType' object has no attribute 'cursor'

(dbconnect) C:\Step_Five_Pipeline_Orchestration\src>SUCCESS: The process with PID 7504 (child process of PID 10360) has been terminated.
SUCCESS: The process with PID 10360 (child process of PID 21060) has been terminated.
SUCCESS: The process with PID 21060 (child process of PID 15320) has been terminated.
python etldriver.py
21/03/23 15:44:30 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 15:44:30 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 15:44:33 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
21/03/23 15:44:44 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 15:44:51,473 :: INFO :: main :: 78 :: Processing raw csv
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:34:51.505|1           |2020-08-05 05:30:00|0E-14            |75.30254839137037|100     |75.35916738004924|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:40:52.586|2           |2020-08-05 05:30:00|0E-14            |77.20874619466693|100     |78.90918015646369|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:50:04.681|3           |2020-08-05 05:30:00|0E-14            |77.15973273251218|100     |77.33204694110470|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:57:46.343|4           |2020-08-05 05:30:00|0E-14            |79.29977331004093|100     |80.08399307353596|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:06:50.886|5           |2020-08-05 05:30:00|0E-14            |77.86349512170780|100     |78.30821537434917|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:11:43.839|6           |2020-08-05 05:30:00|0E-14            |78.74799689143143|100     |80.32905299746953|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:17:02.044|7           |2020-08-05 05:30:00|0E-14            |77.16837620945849|100     |77.97598027909252|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:23:58.216|8           |2020-08-05 05:30:00|0E-14            |78.06551496692607|100     |78.80516026628197|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:31:40.057|9           |2020-08-05 05:30:00|0E-14            |76.69653634240801|100     |78.56942375735030|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 06:37:21.581|10          |2020-08-05 05:30:00|79.19488165597565|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:45:27.205|11          |2020-08-05 05:30:00|0E-14            |75.10473622642823|100     |77.09656190920616|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:54:06.198|12          |2020-08-05 05:30:00|0E-14            |74.52147919052219|100     |75.66916329143558|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:03:24.882|13          |2020-08-05 05:30:00|0E-14            |75.16876091805237|100     |76.70697764844876|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:12:54.259|14          |2020-08-05 05:30:00|0E-14            |74.56633254759171|100     |74.62137517521543|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:19:55.013|15          |2020-08-05 05:30:00|0E-14            |74.49803365619901|100     |76.47591167094056|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:27:34.304|16          |2020-08-05 05:30:00|0E-14            |75.22889133048018|100     |76.14368647113133|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:35:18.534|17          |2020-08-05 05:30:00|0E-14            |76.62791946609745|100     |76.99149298587172|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:42:42.976|18          |2020-08-05 05:30:00|0E-14            |77.09466818643507|100     |78.15967343099572|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:51:08.791|19          |2020-08-05 05:30:00|0E-14            |78.33536506091860|100     |79.39139072379258|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 07:56:13.086|20          |2020-08-05 05:30:00|76.49092501585646|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 15:44:56,720 :: INFO :: main :: 78 :: Processing raw json(0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|0E-14            |76.10016521142818|100     |77.96479759087470|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|0E-14            |75.44372945251948|100     |75.94452858561046|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|0E-14            |78.84798564828422|100     |80.69114407667608|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:53:09.803|4           |2020-08-05 05:30:00|0E-14            |74.98336890552693|100     |76.16256530811053|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:00:10.866|5           |2020-08-05 05:30:00|0E-14            |76.71408448666702|100     |77.85512785142082|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:05:24.344|6           |2020-08-05 05:30:00|0E-14            |76.78900747031288|100     |77.79982571852163|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:13:59.224|7           |2020-08-05 05:30:00|0E-14            |76.37099394549293|100     |76.94631910510188|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:21:43.76 |8           |2020-08-05 05:30:00|0E-14            |77.32601214334609|100     |77.65017757988643|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:30:33.547|9           |2020-08-05 05:30:00|0E-14            |77.11395059665263|100     |77.52985832434904|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:45:54.754|11          |2020-08-05 05:30:00|0E-14            |77.69893211260312|100     |79.18604684163077|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:54:34.696|12          |2020-08-05 05:30:00|0E-14            |75.09529363658093|100     |75.83132049866276|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:02:08.291|13          |2020-08-05 05:30:00|0E-14            |77.76547178321442|100     |79.41345232512326|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:11:36.644|14          |2020-08-05 05:30:00|0E-14            |76.39994032672179|100     |76.83733213626446|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:19:53.959|15          |2020-08-05 05:30:00|0E-14            |79.09882325040374|100     |79.83007081928720|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:29:25.432|16          |2020-08-05 05:30:00|0E-14            |74.72294172166815|100     |76.05085199350985|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:34:40.415|17          |2020-08-05 05:30:00|0E-14            |78.06235033524703|100     |78.36705025855920|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:41:23.633|18          |2020-08-05 05:30:00|0E-14            |78.71683328488820|100     |80.45610125569267|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:50:54.911|19          |2020-08-05 05:30:00|0E-14            |79.17169989748359|100     |80.14798230305898|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 15:44:58,879 :: INFO :: main :: 78 :: Processing eod trade0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 09:09:24.38 |30          |2020-08-05 05:30:00|75.87925515076047|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
only showing top 3 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 15:45:03,357 :: INFO :: main :: 78 :: Processing eod quote0 + 1) / 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |bid_pr           |bid_size|ask_pr           |ask_size|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|76.10016521142818|100     |77.96479759087470|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|75.44372945251948|100     |75.94452858561046|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|78.84798564828422|100     |80.69114407667608|100     |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
only showing top 3 rows

root
 |-- trade_dt: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- event_tm: timestamp (nullable = true)
 |-- event_seq_nb: integer (nullable = true)
 |-- arrival_tm: timestamp (nullable = true)
 |-- bid_pr: decimal(17,14) (nullable = true)
 |-- bid_size: integer (nullable = true)
 |-- ask_pr: decimal(17,14) (nullable = true)
 |-- ask_size: integer (nullable = true)

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 15:45:07,442 :: INFO :: main :: 78 :: Processing analytical_quote/ 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 15:45:11 WARN HintErrorLogger: Count not find relation 'prev_temp_last_trade' specified in hint 'BROADCAST(prev_temp_last_trade)'.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2020-08-06>                                                         (0 + 1) / 1]
2021-03-23 15:45:15,003 :: INFO :: <module> :: 108 :: Updating the job status in the POSTGRES Table
2021-03-23 15:45:15,010 :: INFO :: <module> :: 112 :: Updating the job status
Job ID Assigned: 10
2021-03-23 15:45:17,479 :: INFO :: get_db_connection :: 92 ::  Successfully connected to postgres DB
2021-03-23 15:45:17,480 :: INFO :: update_job_status :: 41 :: Trying to create table spark_job
2021-03-23 15:45:20,139 :: INFO :: update_job_status :: 53 :: Created Table spark_job
2021-03-23 15:45:20,139 :: INFO :: update_job_status :: 55 ::  Updating status of the job in the table

(dbconnect) C:\Step_Five_Pipeline_Orchestration\src>SUCCESS: The process with PID 10944 (child process of PID 14720) has been terminated.
SUCCESS: The process with PID 14720 (child process of PID 17344) has been terminated.
SUCCESS: The process with PID 17344 (child process of PID 20780) has been terminated.
select
'select' is not recognized as an internal or external command,
operable program or batch file.

(dbconnect) C:\Step_Five_Pipeline_Orchestration\src>  *
'*' is not recognized as an internal or external command,
operable program or batch file.

(dbconnect) C:\Step_Five_Pipeline_Orchestration\src>from
'from' is not recognized as an internal or external command,
operable program or batch file.

(dbconnect) C:\Step_Five_Pipeline_Orchestration\src>  pg_catalog.pg_tables
'pg_catalog.pg_tables' is not recognized as an internal or external command,
operable program or batch file.

(dbconnect) C:\Step_Five_Pipeline_Orchestration\src>where
The syntax of this command is:

WHERE [/R dir] [/Q] [/F] [/T] pattern...

Description:
    Displays the location of files that match the search pattern.
    By default, the search is done along the current directory and
    in the paths specified by the PATH environment variable.

Parameter List:
    /R       Recursively searches and displays the files that match the
             given pattern starting from the specified directory.

    /Q       Returns only the exit code, without displaying the list
             of matched files. (Quiet mode)

    /F       Displays the matched filename in double quotes.

    /T       Displays the file size, last modified date and time for all
             matched files.

    pattern  Specifies the search pattern for the files to match.
             Wildcards * and ? can be used in the pattern. The
             "$env:pattern" and "path:pattern" formats can also be
             specified, where "env" is an environment variable and
             the search is done in the specified paths of the "env"
             environment variable. These formats should not be used
             with /R. The search is also done by appending the
             extensions of the PATHEXT variable to the pattern.

     /?      Displays this help message.

  NOTE: The tool returns an error level of 0 if the search is
        successful, of 1 if the search is unsuccessful and
        of 2 for failures or errors.

Examples:
    WHERE /?
    WHERE myfilename1 myfile????.*
    WHERE $windir:*.*
    WHERE /R c:\windows *.exe *.dll *.bat
    WHERE /Q ??.???
    WHERE "c:\windows;c:\windows\system32:*.dll"
    WHERE /F /T *.dll

(dbconnect) C:\Step_Five_Pipeline_Orchestration\src>  schemaname != 'information_schema'
'schemaname' is not recognized as an internal or external command,
operable program or batch file.

(dbconnect) C:\Step_Five_Pipeline_Orchestration\src>python etldriver.py
21/03/23 16:26:40 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 16:26:40 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 16:26:41 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 16:26:54 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:26:54,832 :: INFO :: main :: 78 :: Processing raw csv
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:34:51.505|1           |2020-08-05 05:30:00|0E-14            |75.30254839137037|100     |75.35916738004924|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:40:52.586|2           |2020-08-05 05:30:00|0E-14            |77.20874619466693|100     |78.90918015646369|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:50:04.681|3           |2020-08-05 05:30:00|0E-14            |77.15973273251218|100     |77.33204694110470|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:57:46.343|4           |2020-08-05 05:30:00|0E-14            |79.29977331004093|100     |80.08399307353596|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:06:50.886|5           |2020-08-05 05:30:00|0E-14            |77.86349512170780|100     |78.30821537434917|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:11:43.839|6           |2020-08-05 05:30:00|0E-14            |78.74799689143143|100     |80.32905299746953|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:17:02.044|7           |2020-08-05 05:30:00|0E-14            |77.16837620945849|100     |77.97598027909252|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:23:58.216|8           |2020-08-05 05:30:00|0E-14            |78.06551496692607|100     |78.80516026628197|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:31:40.057|9           |2020-08-05 05:30:00|0E-14            |76.69653634240801|100     |78.56942375735030|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 06:37:21.581|10          |2020-08-05 05:30:00|79.19488165597565|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:45:27.205|11          |2020-08-05 05:30:00|0E-14            |75.10473622642823|100     |77.09656190920616|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:54:06.198|12          |2020-08-05 05:30:00|0E-14            |74.52147919052219|100     |75.66916329143558|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:03:24.882|13          |2020-08-05 05:30:00|0E-14            |75.16876091805237|100     |76.70697764844876|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:12:54.259|14          |2020-08-05 05:30:00|0E-14            |74.56633254759171|100     |74.62137517521543|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:19:55.013|15          |2020-08-05 05:30:00|0E-14            |74.49803365619901|100     |76.47591167094056|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:27:34.304|16          |2020-08-05 05:30:00|0E-14            |75.22889133048018|100     |76.14368647113133|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:35:18.534|17          |2020-08-05 05:30:00|0E-14            |76.62791946609745|100     |76.99149298587172|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:42:42.976|18          |2020-08-05 05:30:00|0E-14            |77.09466818643507|100     |78.15967343099572|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:51:08.791|19          |2020-08-05 05:30:00|0E-14            |78.33536506091860|100     |79.39139072379258|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 07:56:13.086|20          |2020-08-05 05:30:00|76.49092501585646|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:26:58,746 :: INFO :: main :: 78 :: Processing raw json(0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|0E-14            |76.10016521142818|100     |77.96479759087470|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|0E-14            |75.44372945251948|100     |75.94452858561046|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|0E-14            |78.84798564828422|100     |80.69114407667608|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:53:09.803|4           |2020-08-05 05:30:00|0E-14            |74.98336890552693|100     |76.16256530811053|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:00:10.866|5           |2020-08-05 05:30:00|0E-14            |76.71408448666702|100     |77.85512785142082|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:05:24.344|6           |2020-08-05 05:30:00|0E-14            |76.78900747031288|100     |77.79982571852163|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:13:59.224|7           |2020-08-05 05:30:00|0E-14            |76.37099394549293|100     |76.94631910510188|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:21:43.76 |8           |2020-08-05 05:30:00|0E-14            |77.32601214334609|100     |77.65017757988643|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:30:33.547|9           |2020-08-05 05:30:00|0E-14            |77.11395059665263|100     |77.52985832434904|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:45:54.754|11          |2020-08-05 05:30:00|0E-14            |77.69893211260312|100     |79.18604684163077|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:54:34.696|12          |2020-08-05 05:30:00|0E-14            |75.09529363658093|100     |75.83132049866276|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:02:08.291|13          |2020-08-05 05:30:00|0E-14            |77.76547178321442|100     |79.41345232512326|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:11:36.644|14          |2020-08-05 05:30:00|0E-14            |76.39994032672179|100     |76.83733213626446|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:19:53.959|15          |2020-08-05 05:30:00|0E-14            |79.09882325040374|100     |79.83007081928720|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:29:25.432|16          |2020-08-05 05:30:00|0E-14            |74.72294172166815|100     |76.05085199350985|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:34:40.415|17          |2020-08-05 05:30:00|0E-14            |78.06235033524703|100     |78.36705025855920|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:41:23.633|18          |2020-08-05 05:30:00|0E-14            |78.71683328488820|100     |80.45610125569267|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:50:54.911|19          |2020-08-05 05:30:00|0E-14            |79.17169989748359|100     |80.14798230305898|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:27:00,898 :: INFO :: main :: 78 :: Processing eod trade0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 09:09:24.38 |30          |2020-08-05 05:30:00|75.87925515076047|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
only showing top 3 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:27:04,597 :: INFO :: main :: 78 :: Processing eod quote0 + 1) / 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |bid_pr           |bid_size|ask_pr           |ask_size|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|76.10016521142818|100     |77.96479759087470|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|75.44372945251948|100     |75.94452858561046|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|78.84798564828422|100     |80.69114407667608|100     |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
only showing top 3 rows

root
 |-- trade_dt: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- event_tm: timestamp (nullable = true)
 |-- event_seq_nb: integer (nullable = true)
 |-- arrival_tm: timestamp (nullable = true)
 |-- bid_pr: decimal(17,14) (nullable = true)
 |-- bid_size: integer (nullable = true)
 |-- ask_pr: decimal(17,14) (nullable = true)
 |-- ask_size: integer (nullable = true)

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:27:08,466 :: INFO :: main :: 78 :: Processing analytical_quote/ 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 16:27:11 WARN HintErrorLogger: Count not find relation 'prev_temp_last_trade' specified in hint 'BROADCAST(prev_temp_last_trade)'.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
"2020-08-06"                                                        (0 + 1) / 1]
2021-03-23 16:27:14,659 :: INFO :: <module> :: 108 :: Updating the job status in the POSTGRES Table
2021-03-23 16:27:14,661 :: INFO :: <module> :: 112 :: Updating the job status
Job ID Assigned: 9
2021-03-23 16:27:16,254 :: INFO :: get_db_connection :: 94 ::  Successfully connected to postgres DB
2021-03-23 16:27:16,255 :: INFO :: update_job_status :: 41 :: Trying to create table "spark_job"
2021-03-23 16:27:16,736 :: INFO :: update_job_status :: 53 :: Created Table "spark_job"
2021-03-23 16:27:16,736 :: INFO :: update_job_status :: 55 ::  Updating status of the job in the table

(dbconnect) C:\Step_Five_Pipeline_Orchestration\src>SUCCESS: The process with PID 22704 (child process of PID 4044) has been terminated.
SUCCESS: The process with PID 4044 (child process of PID 22756) has been terminated.
SUCCESS: The process with PID 22756 (child process of PID 15720) has been terminated.
python etldriver.py
21/03/23 16:30:37 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 16:30:37 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 16:30:38 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 16:30:49 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:30:51,771 :: INFO :: main :: 78 :: Processing raw csv
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:34:51.505|1           |2020-08-05 05:30:00|0E-14            |75.30254839137037|100     |75.35916738004924|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:40:52.586|2           |2020-08-05 05:30:00|0E-14            |77.20874619466693|100     |78.90918015646369|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:50:04.681|3           |2020-08-05 05:30:00|0E-14            |77.15973273251218|100     |77.33204694110470|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:57:46.343|4           |2020-08-05 05:30:00|0E-14            |79.29977331004093|100     |80.08399307353596|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:06:50.886|5           |2020-08-05 05:30:00|0E-14            |77.86349512170780|100     |78.30821537434917|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:11:43.839|6           |2020-08-05 05:30:00|0E-14            |78.74799689143143|100     |80.32905299746953|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:17:02.044|7           |2020-08-05 05:30:00|0E-14            |77.16837620945849|100     |77.97598027909252|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:23:58.216|8           |2020-08-05 05:30:00|0E-14            |78.06551496692607|100     |78.80516026628197|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:31:40.057|9           |2020-08-05 05:30:00|0E-14            |76.69653634240801|100     |78.56942375735030|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 06:37:21.581|10          |2020-08-05 05:30:00|79.19488165597565|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:45:27.205|11          |2020-08-05 05:30:00|0E-14            |75.10473622642823|100     |77.09656190920616|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:54:06.198|12          |2020-08-05 05:30:00|0E-14            |74.52147919052219|100     |75.66916329143558|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:03:24.882|13          |2020-08-05 05:30:00|0E-14            |75.16876091805237|100     |76.70697764844876|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:12:54.259|14          |2020-08-05 05:30:00|0E-14            |74.56633254759171|100     |74.62137517521543|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:19:55.013|15          |2020-08-05 05:30:00|0E-14            |74.49803365619901|100     |76.47591167094056|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:27:34.304|16          |2020-08-05 05:30:00|0E-14            |75.22889133048018|100     |76.14368647113133|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:35:18.534|17          |2020-08-05 05:30:00|0E-14            |76.62791946609745|100     |76.99149298587172|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:42:42.976|18          |2020-08-05 05:30:00|0E-14            |77.09466818643507|100     |78.15967343099572|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:51:08.791|19          |2020-08-05 05:30:00|0E-14            |78.33536506091860|100     |79.39139072379258|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 07:56:13.086|20          |2020-08-05 05:30:00|76.49092501585646|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:30:55,591 :: INFO :: main :: 78 :: Processing raw json(1 + 1) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|0E-14            |76.10016521142818|100     |77.96479759087470|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|0E-14            |75.44372945251948|100     |75.94452858561046|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|0E-14            |78.84798564828422|100     |80.69114407667608|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:53:09.803|4           |2020-08-05 05:30:00|0E-14            |74.98336890552693|100     |76.16256530811053|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:00:10.866|5           |2020-08-05 05:30:00|0E-14            |76.71408448666702|100     |77.85512785142082|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:05:24.344|6           |2020-08-05 05:30:00|0E-14            |76.78900747031288|100     |77.79982571852163|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:13:59.224|7           |2020-08-05 05:30:00|0E-14            |76.37099394549293|100     |76.94631910510188|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:21:43.76 |8           |2020-08-05 05:30:00|0E-14            |77.32601214334609|100     |77.65017757988643|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:30:33.547|9           |2020-08-05 05:30:00|0E-14            |77.11395059665263|100     |77.52985832434904|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:45:54.754|11          |2020-08-05 05:30:00|0E-14            |77.69893211260312|100     |79.18604684163077|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:54:34.696|12          |2020-08-05 05:30:00|0E-14            |75.09529363658093|100     |75.83132049866276|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:02:08.291|13          |2020-08-05 05:30:00|0E-14            |77.76547178321442|100     |79.41345232512326|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:11:36.644|14          |2020-08-05 05:30:00|0E-14            |76.39994032672179|100     |76.83733213626446|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:19:53.959|15          |2020-08-05 05:30:00|0E-14            |79.09882325040374|100     |79.83007081928720|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:29:25.432|16          |2020-08-05 05:30:00|0E-14            |74.72294172166815|100     |76.05085199350985|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:34:40.415|17          |2020-08-05 05:30:00|0E-14            |78.06235033524703|100     |78.36705025855920|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:41:23.633|18          |2020-08-05 05:30:00|0E-14            |78.71683328488820|100     |80.45610125569267|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:50:54.911|19          |2020-08-05 05:30:00|0E-14            |79.17169989748359|100     |80.14798230305898|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:30:57,481 :: INFO :: main :: 78 :: Processing eod trade0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 09:09:24.38 |30          |2020-08-05 05:30:00|75.87925515076047|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
only showing top 3 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:31:01,389 :: INFO :: main :: 78 :: Processing eod quote0 + 1) / 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |bid_pr           |bid_size|ask_pr           |ask_size|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|76.10016521142818|100     |77.96479759087470|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|75.44372945251948|100     |75.94452858561046|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|78.84798564828422|100     |80.69114407667608|100     |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
only showing top 3 rows

root
 |-- trade_dt: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- event_tm: timestamp (nullable = true)
 |-- event_seq_nb: integer (nullable = true)
 |-- arrival_tm: timestamp (nullable = true)
 |-- bid_pr: decimal(17,14) (nullable = true)
 |-- bid_size: integer (nullable = true)
 |-- ask_pr: decimal(17,14) (nullable = true)
 |-- ask_size: integer (nullable = true)

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:31:05,229 :: INFO :: main :: 78 :: Processing analytical_quote/ 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 16:31:08 WARN HintErrorLogger: Count not find relation 'prev_temp_last_trade' specified in hint 'BROADCAST(prev_temp_last_trade)'.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
"2020-08-06"                                                        (0 + 1) / 1]
2021-03-23 16:31:11,678 :: INFO :: <module> :: 108 :: Updating the job status in the POSTGRES Table
2021-03-23 16:31:11,680 :: INFO :: <module> :: 112 :: Updating the job status
Job ID Assigned: 2
2021-03-23 16:31:13,075 :: INFO :: get_db_connection :: 94 ::  Successfully connected to postgres DB
2021-03-23 16:31:13,076 :: INFO :: update_job_status :: 41 :: Trying to create table "guided_spark_job"
2021-03-23 16:31:13,308 :: INFO :: update_job_status :: 53 :: Created Table "guided_spark_job" for job_id: 2
2021-03-23 16:31:13,309 :: INFO :: update_job_status :: 55 ::  Updating status of the job in the table

(dbconnect) C:\Step_Five_Pipeline_Orchestration\src>SUCCESS: The process with PID 22812 (child process of PID 20768) has been terminated.
SUCCESS: The process with PID 20768 (child process of PID 18496) has been terminated.
SUCCESS: The process with PID 18496 (child process of PID 8668) has been terminated.
python etldriver.py
21/03/23 16:37:48 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 16:37:48 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 16:37:50 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:38:03,162 :: INFO :: main :: 78 :: Processing raw csv
21/03/23 16:38:04 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:34:51.505|1           |2020-08-05 05:30:00|0E-14            |75.30254839137037|100     |75.35916738004924|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:40:52.586|2           |2020-08-05 05:30:00|0E-14            |77.20874619466693|100     |78.90918015646369|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:50:04.681|3           |2020-08-05 05:30:00|0E-14            |77.15973273251218|100     |77.33204694110470|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:57:46.343|4           |2020-08-05 05:30:00|0E-14            |79.29977331004093|100     |80.08399307353596|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:06:50.886|5           |2020-08-05 05:30:00|0E-14            |77.86349512170780|100     |78.30821537434917|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:11:43.839|6           |2020-08-05 05:30:00|0E-14            |78.74799689143143|100     |80.32905299746953|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:17:02.044|7           |2020-08-05 05:30:00|0E-14            |77.16837620945849|100     |77.97598027909252|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:23:58.216|8           |2020-08-05 05:30:00|0E-14            |78.06551496692607|100     |78.80516026628197|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:31:40.057|9           |2020-08-05 05:30:00|0E-14            |76.69653634240801|100     |78.56942375735030|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 06:37:21.581|10          |2020-08-05 05:30:00|79.19488165597565|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:45:27.205|11          |2020-08-05 05:30:00|0E-14            |75.10473622642823|100     |77.09656190920616|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:54:06.198|12          |2020-08-05 05:30:00|0E-14            |74.52147919052219|100     |75.66916329143558|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:03:24.882|13          |2020-08-05 05:30:00|0E-14            |75.16876091805237|100     |76.70697764844876|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:12:54.259|14          |2020-08-05 05:30:00|0E-14            |74.56633254759171|100     |74.62137517521543|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:19:55.013|15          |2020-08-05 05:30:00|0E-14            |74.49803365619901|100     |76.47591167094056|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:27:34.304|16          |2020-08-05 05:30:00|0E-14            |75.22889133048018|100     |76.14368647113133|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:35:18.534|17          |2020-08-05 05:30:00|0E-14            |76.62791946609745|100     |76.99149298587172|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:42:42.976|18          |2020-08-05 05:30:00|0E-14            |77.09466818643507|100     |78.15967343099572|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:51:08.791|19          |2020-08-05 05:30:00|0E-14            |78.33536506091860|100     |79.39139072379258|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 07:56:13.086|20          |2020-08-05 05:30:00|76.49092501585646|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:38:27,994 :: INFO :: main :: 78 :: Processing raw json(0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|0E-14            |76.10016521142818|100     |77.96479759087470|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|0E-14            |75.44372945251948|100     |75.94452858561046|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|0E-14            |78.84798564828422|100     |80.69114407667608|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:53:09.803|4           |2020-08-05 05:30:00|0E-14            |74.98336890552693|100     |76.16256530811053|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:00:10.866|5           |2020-08-05 05:30:00|0E-14            |76.71408448666702|100     |77.85512785142082|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:05:24.344|6           |2020-08-05 05:30:00|0E-14            |76.78900747031288|100     |77.79982571852163|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:13:59.224|7           |2020-08-05 05:30:00|0E-14            |76.37099394549293|100     |76.94631910510188|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:21:43.76 |8           |2020-08-05 05:30:00|0E-14            |77.32601214334609|100     |77.65017757988643|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:30:33.547|9           |2020-08-05 05:30:00|0E-14            |77.11395059665263|100     |77.52985832434904|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:45:54.754|11          |2020-08-05 05:30:00|0E-14            |77.69893211260312|100     |79.18604684163077|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:54:34.696|12          |2020-08-05 05:30:00|0E-14            |75.09529363658093|100     |75.83132049866276|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:02:08.291|13          |2020-08-05 05:30:00|0E-14            |77.76547178321442|100     |79.41345232512326|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:11:36.644|14          |2020-08-05 05:30:00|0E-14            |76.39994032672179|100     |76.83733213626446|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:19:53.959|15          |2020-08-05 05:30:00|0E-14            |79.09882325040374|100     |79.83007081928720|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:29:25.432|16          |2020-08-05 05:30:00|0E-14            |74.72294172166815|100     |76.05085199350985|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:34:40.415|17          |2020-08-05 05:30:00|0E-14            |78.06235033524703|100     |78.36705025855920|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:41:23.633|18          |2020-08-05 05:30:00|0E-14            |78.71683328488820|100     |80.45610125569267|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:50:54.911|19          |2020-08-05 05:30:00|0E-14            |79.17169989748359|100     |80.14798230305898|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:38:30,190 :: INFO :: main :: 78 :: Processing eod trade0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 09:09:24.38 |30          |2020-08-05 05:30:00|75.87925515076047|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
only showing top 3 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:38:33,372 :: INFO :: main :: 78 :: Processing eod quote0 + 1) / 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |bid_pr           |bid_size|ask_pr           |ask_size|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|76.10016521142818|100     |77.96479759087470|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|75.44372945251948|100     |75.94452858561046|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|78.84798564828422|100     |80.69114407667608|100     |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
only showing top 3 rows

root
 |-- trade_dt: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- event_tm: timestamp (nullable = true)
 |-- event_seq_nb: integer (nullable = true)
 |-- arrival_tm: timestamp (nullable = true)
 |-- bid_pr: decimal(17,14) (nullable = true)
 |-- bid_size: integer (nullable = true)
 |-- ask_pr: decimal(17,14) (nullable = true)
 |-- ask_size: integer (nullable = true)

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:38:37,091 :: INFO :: main :: 78 :: Processing analytical_quote/ 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 16:38:40 WARN HintErrorLogger: Count not find relation 'prev_temp_last_trade' specified in hint 'BROADCAST(prev_temp_last_trade)'.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
"2020-08-06"                                                        (0 + 1) / 1]
2021-03-23 16:38:43,355 :: INFO :: <module> :: 108 :: Updating the job status in the POSTGRES Table
2021-03-23 16:38:43,358 :: INFO :: <module> :: 112 :: Updating the job status
Job ID Assigned: 8
2021-03-23 16:38:45,161 :: INFO :: get_db_connection :: 104 ::  Successfully connected to postgres DB
2021-03-23 16:38:45,162 :: INFO :: update_job_status :: 41 :: Trying to create table "guided_spark_job"
2021-03-23 16:38:46,035 :: INFO :: update_job_status :: 53 :: Created Table "guided_spark_job" for job_id: 8
2021-03-23 16:38:46,036 :: INFO :: update_job_status :: 55 ::  Updating status of the job in the table
2021-03-23 16:38:46,262 :: ERROR :: update_job_status :: 78 :: Error getting value from the Database relation "guided_spark_job" does not exist
LINE 1: SELECT * FROM "guided_spark_job"
                      ^


(dbconnect) C:\Step_Five_Pipeline_Orchestration\src>SUCCESS: The process with PID 4844 (child process of PID 22348) has been terminated.
SUCCESS: The process with PID 22348 (child process of PID 4376) has been terminated.
SUCCESS: The process with PID 4376 (child process of PID 15000) has been terminated.
python etldriver.py
21/03/23 16:39:38 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 16:39:38 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 16:39:40 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 16:39:52 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:39:53,244 :: INFO :: main :: 78 :: Processing raw csv
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:34:51.505|1           |2020-08-05 05:30:00|0E-14            |75.30254839137037|100     |75.35916738004924|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:40:52.586|2           |2020-08-05 05:30:00|0E-14            |77.20874619466693|100     |78.90918015646369|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:50:04.681|3           |2020-08-05 05:30:00|0E-14            |77.15973273251218|100     |77.33204694110470|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:57:46.343|4           |2020-08-05 05:30:00|0E-14            |79.29977331004093|100     |80.08399307353596|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:06:50.886|5           |2020-08-05 05:30:00|0E-14            |77.86349512170780|100     |78.30821537434917|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:11:43.839|6           |2020-08-05 05:30:00|0E-14            |78.74799689143143|100     |80.32905299746953|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:17:02.044|7           |2020-08-05 05:30:00|0E-14            |77.16837620945849|100     |77.97598027909252|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:23:58.216|8           |2020-08-05 05:30:00|0E-14            |78.06551496692607|100     |78.80516026628197|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:31:40.057|9           |2020-08-05 05:30:00|0E-14            |76.69653634240801|100     |78.56942375735030|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 06:37:21.581|10          |2020-08-05 05:30:00|79.19488165597565|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:45:27.205|11          |2020-08-05 05:30:00|0E-14            |75.10473622642823|100     |77.09656190920616|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:54:06.198|12          |2020-08-05 05:30:00|0E-14            |74.52147919052219|100     |75.66916329143558|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:03:24.882|13          |2020-08-05 05:30:00|0E-14            |75.16876091805237|100     |76.70697764844876|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:12:54.259|14          |2020-08-05 05:30:00|0E-14            |74.56633254759171|100     |74.62137517521543|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:19:55.013|15          |2020-08-05 05:30:00|0E-14            |74.49803365619901|100     |76.47591167094056|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:27:34.304|16          |2020-08-05 05:30:00|0E-14            |75.22889133048018|100     |76.14368647113133|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:35:18.534|17          |2020-08-05 05:30:00|0E-14            |76.62791946609745|100     |76.99149298587172|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:42:42.976|18          |2020-08-05 05:30:00|0E-14            |77.09466818643507|100     |78.15967343099572|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:51:08.791|19          |2020-08-05 05:30:00|0E-14            |78.33536506091860|100     |79.39139072379258|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 07:56:13.086|20          |2020-08-05 05:30:00|76.49092501585646|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:39:56,876 :: INFO :: main :: 78 :: Processing raw json(0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|0E-14            |76.10016521142818|100     |77.96479759087470|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|0E-14            |75.44372945251948|100     |75.94452858561046|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|0E-14            |78.84798564828422|100     |80.69114407667608|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:53:09.803|4           |2020-08-05 05:30:00|0E-14            |74.98336890552693|100     |76.16256530811053|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:00:10.866|5           |2020-08-05 05:30:00|0E-14            |76.71408448666702|100     |77.85512785142082|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:05:24.344|6           |2020-08-05 05:30:00|0E-14            |76.78900747031288|100     |77.79982571852163|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:13:59.224|7           |2020-08-05 05:30:00|0E-14            |76.37099394549293|100     |76.94631910510188|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:21:43.76 |8           |2020-08-05 05:30:00|0E-14            |77.32601214334609|100     |77.65017757988643|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:30:33.547|9           |2020-08-05 05:30:00|0E-14            |77.11395059665263|100     |77.52985832434904|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:45:54.754|11          |2020-08-05 05:30:00|0E-14            |77.69893211260312|100     |79.18604684163077|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:54:34.696|12          |2020-08-05 05:30:00|0E-14            |75.09529363658093|100     |75.83132049866276|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:02:08.291|13          |2020-08-05 05:30:00|0E-14            |77.76547178321442|100     |79.41345232512326|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:11:36.644|14          |2020-08-05 05:30:00|0E-14            |76.39994032672179|100     |76.83733213626446|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:19:53.959|15          |2020-08-05 05:30:00|0E-14            |79.09882325040374|100     |79.83007081928720|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:29:25.432|16          |2020-08-05 05:30:00|0E-14            |74.72294172166815|100     |76.05085199350985|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:34:40.415|17          |2020-08-05 05:30:00|0E-14            |78.06235033524703|100     |78.36705025855920|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:41:23.633|18          |2020-08-05 05:30:00|0E-14            |78.71683328488820|100     |80.45610125569267|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:50:54.911|19          |2020-08-05 05:30:00|0E-14            |79.17169989748359|100     |80.14798230305898|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:39:58,776 :: INFO :: main :: 78 :: Processing eod trade0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 09:09:24.38 |30          |2020-08-05 05:30:00|75.87925515076047|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
only showing top 3 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:40:02,389 :: INFO :: main :: 78 :: Processing eod quote0 + 1) / 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |bid_pr           |bid_size|ask_pr           |ask_size|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|76.10016521142818|100     |77.96479759087470|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|75.44372945251948|100     |75.94452858561046|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|78.84798564828422|100     |80.69114407667608|100     |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
only showing top 3 rows

root
 |-- trade_dt: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- event_tm: timestamp (nullable = true)
 |-- event_seq_nb: integer (nullable = true)
 |-- arrival_tm: timestamp (nullable = true)
 |-- bid_pr: decimal(17,14) (nullable = true)
 |-- bid_size: integer (nullable = true)
 |-- ask_pr: decimal(17,14) (nullable = true)
 |-- ask_size: integer (nullable = true)

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 16:40:06,894 :: INFO :: main :: 78 :: Processing analytical_quote/ 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 16:40:10 WARN HintErrorLogger: Count not find relation 'prev_temp_last_trade' specified in hint 'BROADCAST(prev_temp_last_trade)'.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2020-08-06:>                                                        (0 + 1) / 1]
2021-03-23 16:40:13,230 :: INFO :: <module> :: 108 :: Updating the job status in the POSTGRES Table
2021-03-23 16:40:13,236 :: INFO :: <module> :: 112 :: Updating the job status
Job ID Assigned: 6
2021-03-23 16:40:14,836 :: INFO :: get_db_connection :: 104 ::  Successfully connected to postgres DB
2021-03-23 16:40:14,836 :: INFO :: update_job_status :: 41 :: Trying to create table guided_spark_job
2021-03-23 16:40:15,014 :: INFO :: update_job_status :: 53 :: Created Table guided_spark_job for job_id: 6
2021-03-23 16:40:15,015 :: INFO :: update_job_status :: 55 ::  Updating status of the job in the table
2021-03-23 16:40:15,301 :: INFO :: update_job_status :: 72 :: Data row = (6, analytical_etl, success, 2020-08-06)

(dbconnect) C:\Step_Five_Pipeline_Orchestration\src>SUCCESS: The process with PID 2692 (child process of PID 14724) has been terminated.
SUCCESS: The process with PID 14724 (child process of PID 22872) has been terminated.
SUCCESS: The process with PID 22872 (child process of PID 23184) has been terminated.
python etldriver.py
21/03/23 17:01:51 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 17:01:51 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 17:01:54 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 17:02:10 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 17:02:13,034 :: INFO :: main :: 78 :: Processing raw csv
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:34:51.505|1           |2020-08-05 05:30:00|0E-14            |75.30254839137037|100     |75.35916738004924|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:40:52.586|2           |2020-08-05 05:30:00|0E-14            |77.20874619466693|100     |78.90918015646369|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:50:04.681|3           |2020-08-05 05:30:00|0E-14            |77.15973273251218|100     |77.33204694110470|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:57:46.343|4           |2020-08-05 05:30:00|0E-14            |79.29977331004093|100     |80.08399307353596|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:06:50.886|5           |2020-08-05 05:30:00|0E-14            |77.86349512170780|100     |78.30821537434917|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:11:43.839|6           |2020-08-05 05:30:00|0E-14            |78.74799689143143|100     |80.32905299746953|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:17:02.044|7           |2020-08-05 05:30:00|0E-14            |77.16837620945849|100     |77.97598027909252|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:23:58.216|8           |2020-08-05 05:30:00|0E-14            |78.06551496692607|100     |78.80516026628197|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:31:40.057|9           |2020-08-05 05:30:00|0E-14            |76.69653634240801|100     |78.56942375735030|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 06:37:21.581|10          |2020-08-05 05:30:00|79.19488165597565|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:45:27.205|11          |2020-08-05 05:30:00|0E-14            |75.10473622642823|100     |77.09656190920616|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:54:06.198|12          |2020-08-05 05:30:00|0E-14            |74.52147919052219|100     |75.66916329143558|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:03:24.882|13          |2020-08-05 05:30:00|0E-14            |75.16876091805237|100     |76.70697764844876|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:12:54.259|14          |2020-08-05 05:30:00|0E-14            |74.56633254759171|100     |74.62137517521543|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:19:55.013|15          |2020-08-05 05:30:00|0E-14            |74.49803365619901|100     |76.47591167094056|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:27:34.304|16          |2020-08-05 05:30:00|0E-14            |75.22889133048018|100     |76.14368647113133|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:35:18.534|17          |2020-08-05 05:30:00|0E-14            |76.62791946609745|100     |76.99149298587172|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:42:42.976|18          |2020-08-05 05:30:00|0E-14            |77.09466818643507|100     |78.15967343099572|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:51:08.791|19          |2020-08-05 05:30:00|0E-14            |78.33536506091860|100     |79.39139072379258|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 07:56:13.086|20          |2020-08-05 05:30:00|76.49092501585646|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 17:02:17,792 :: INFO :: main :: 78 :: Processing raw json(0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|0E-14            |76.10016521142818|100     |77.96479759087470|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|0E-14            |75.44372945251948|100     |75.94452858561046|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|0E-14            |78.84798564828422|100     |80.69114407667608|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:53:09.803|4           |2020-08-05 05:30:00|0E-14            |74.98336890552693|100     |76.16256530811053|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:00:10.866|5           |2020-08-05 05:30:00|0E-14            |76.71408448666702|100     |77.85512785142082|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:05:24.344|6           |2020-08-05 05:30:00|0E-14            |76.78900747031288|100     |77.79982571852163|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:13:59.224|7           |2020-08-05 05:30:00|0E-14            |76.37099394549293|100     |76.94631910510188|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:21:43.76 |8           |2020-08-05 05:30:00|0E-14            |77.32601214334609|100     |77.65017757988643|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:30:33.547|9           |2020-08-05 05:30:00|0E-14            |77.11395059665263|100     |77.52985832434904|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:45:54.754|11          |2020-08-05 05:30:00|0E-14            |77.69893211260312|100     |79.18604684163077|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:54:34.696|12          |2020-08-05 05:30:00|0E-14            |75.09529363658093|100     |75.83132049866276|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:02:08.291|13          |2020-08-05 05:30:00|0E-14            |77.76547178321442|100     |79.41345232512326|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:11:36.644|14          |2020-08-05 05:30:00|0E-14            |76.39994032672179|100     |76.83733213626446|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:19:53.959|15          |2020-08-05 05:30:00|0E-14            |79.09882325040374|100     |79.83007081928720|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:29:25.432|16          |2020-08-05 05:30:00|0E-14            |74.72294172166815|100     |76.05085199350985|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:34:40.415|17          |2020-08-05 05:30:00|0E-14            |78.06235033524703|100     |78.36705025855920|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:41:23.633|18          |2020-08-05 05:30:00|0E-14            |78.71683328488820|100     |80.45610125569267|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:50:54.911|19          |2020-08-05 05:30:00|0E-14            |79.17169989748359|100     |80.14798230305898|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 17:02:19,918 :: INFO :: main :: 78 :: Processing eod trade0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 09:09:24.38 |30          |2020-08-05 05:30:00|75.87925515076047|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
only showing top 3 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 17:02:24,856 :: INFO :: main :: 78 :: Processing eod quote0 + 1) / 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |bid_pr           |bid_size|ask_pr           |ask_size|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|76.10016521142818|100     |77.96479759087470|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|75.44372945251948|100     |75.94452858561046|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|78.84798564828422|100     |80.69114407667608|100     |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
only showing top 3 rows

root
 |-- trade_dt: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- event_tm: timestamp (nullable = true)
 |-- event_seq_nb: integer (nullable = true)
 |-- arrival_tm: timestamp (nullable = true)
 |-- bid_pr: decimal(17,14) (nullable = true)
 |-- bid_size: integer (nullable = true)
 |-- ask_pr: decimal(17,14) (nullable = true)
 |-- ask_size: integer (nullable = true)

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 17:02:28,860 :: INFO :: main :: 78 :: Processing analytical_quote/ 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 17:02:32 WARN HintErrorLogger: Count not find relation 'prev_temp_last_trade' specified in hint 'BROADCAST(prev_temp_last_trade)'.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2020-08-06:>                                                        (0 + 1) / 1]
2021-03-23 17:02:36,019 :: INFO :: <module> :: 108 :: Updating the job status in the POSTGRES Table
2021-03-23 17:02:36,028 :: INFO :: <module> :: 112 :: Updating the job status
Job ID Assigned: 4
2021-03-23 17:02:38,067 :: INFO :: get_db_connection :: 121 ::  Successfully connected to postgres DB
2021-03-23 17:02:38,070 :: INFO :: update_job_status :: 41 :: Trying to create table guided_spark_job
2021-03-23 17:02:38,682 :: INFO :: update_job_status :: 53 :: Created Table guided_spark_job for job_id: 4
2021-03-23 17:02:38,684 :: INFO :: update_job_status :: 55 ::  Updating status of the job in the table
Finished creating table
2021-03-23 17:02:39,809 :: INFO :: update_job_status :: 74 :: Printing the output of spark job table guided_spark_job
2021-03-23 17:02:40,151 :: INFO :: update_job_status :: 80 :: Data row = (4, analytical_etl, success, 2020-08-06)
2021-03-23 17:02:40,152 :: INFO :: update_job_status :: 82 :: Printing the output of Inventory table
2021-03-23 17:02:40,226 :: INFO :: update_job_status :: 89 :: Data row = (1, banana, 150)
2021-03-23 17:02:40,227 :: INFO :: update_job_status :: 89 :: Data row = (2, orange, 154)
2021-03-23 17:02:40,234 :: INFO :: update_job_status :: 89 :: Data row = (3, apple, 100)

(dbconnect) C:\Step_Five_Pipeline_Orchestration\src>SUCCESS: The process with PID 7524 (child process of PID 7548) has been terminated.
SUCCESS: The process with PID 7548 (child process of PID 2520) has been terminated.
SUCCESS: The process with PID 2520 (child process of PID 4348) has been terminated.
python etldriver.py
21/03/23 17:09:54 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 17:09:54 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 17:09:56 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
21/03/23 17:10:07 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 17:10:13,819 :: INFO :: main :: 78 :: Processing raw csv
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:34:51.505|1           |2020-08-05 05:30:00|0E-14            |75.30254839137037|100     |75.35916738004924|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:40:52.586|2           |2020-08-05 05:30:00|0E-14            |77.20874619466693|100     |78.90918015646369|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:50:04.681|3           |2020-08-05 05:30:00|0E-14            |77.15973273251218|100     |77.33204694110470|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:57:46.343|4           |2020-08-05 05:30:00|0E-14            |79.29977331004093|100     |80.08399307353596|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:06:50.886|5           |2020-08-05 05:30:00|0E-14            |77.86349512170780|100     |78.30821537434917|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:11:43.839|6           |2020-08-05 05:30:00|0E-14            |78.74799689143143|100     |80.32905299746953|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:17:02.044|7           |2020-08-05 05:30:00|0E-14            |77.16837620945849|100     |77.97598027909252|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:23:58.216|8           |2020-08-05 05:30:00|0E-14            |78.06551496692607|100     |78.80516026628197|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:31:40.057|9           |2020-08-05 05:30:00|0E-14            |76.69653634240801|100     |78.56942375735030|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 06:37:21.581|10          |2020-08-05 05:30:00|79.19488165597565|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:45:27.205|11          |2020-08-05 05:30:00|0E-14            |75.10473622642823|100     |77.09656190920616|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:54:06.198|12          |2020-08-05 05:30:00|0E-14            |74.52147919052219|100     |75.66916329143558|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:03:24.882|13          |2020-08-05 05:30:00|0E-14            |75.16876091805237|100     |76.70697764844876|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:12:54.259|14          |2020-08-05 05:30:00|0E-14            |74.56633254759171|100     |74.62137517521543|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:19:55.013|15          |2020-08-05 05:30:00|0E-14            |74.49803365619901|100     |76.47591167094056|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:27:34.304|16          |2020-08-05 05:30:00|0E-14            |75.22889133048018|100     |76.14368647113133|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:35:18.534|17          |2020-08-05 05:30:00|0E-14            |76.62791946609745|100     |76.99149298587172|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:42:42.976|18          |2020-08-05 05:30:00|0E-14            |77.09466818643507|100     |78.15967343099572|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:51:08.791|19          |2020-08-05 05:30:00|0E-14            |78.33536506091860|100     |79.39139072379258|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 07:56:13.086|20          |2020-08-05 05:30:00|76.49092501585646|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 17:10:18,446 :: INFO :: main :: 78 :: Processing raw json(0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|0E-14            |76.10016521142818|100     |77.96479759087470|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|0E-14            |75.44372945251948|100     |75.94452858561046|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|0E-14            |78.84798564828422|100     |80.69114407667608|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:53:09.803|4           |2020-08-05 05:30:00|0E-14            |74.98336890552693|100     |76.16256530811053|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:00:10.866|5           |2020-08-05 05:30:00|0E-14            |76.71408448666702|100     |77.85512785142082|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:05:24.344|6           |2020-08-05 05:30:00|0E-14            |76.78900747031288|100     |77.79982571852163|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:13:59.224|7           |2020-08-05 05:30:00|0E-14            |76.37099394549293|100     |76.94631910510188|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:21:43.76 |8           |2020-08-05 05:30:00|0E-14            |77.32601214334609|100     |77.65017757988643|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:30:33.547|9           |2020-08-05 05:30:00|0E-14            |77.11395059665263|100     |77.52985832434904|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:45:54.754|11          |2020-08-05 05:30:00|0E-14            |77.69893211260312|100     |79.18604684163077|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:54:34.696|12          |2020-08-05 05:30:00|0E-14            |75.09529363658093|100     |75.83132049866276|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:02:08.291|13          |2020-08-05 05:30:00|0E-14            |77.76547178321442|100     |79.41345232512326|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:11:36.644|14          |2020-08-05 05:30:00|0E-14            |76.39994032672179|100     |76.83733213626446|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:19:53.959|15          |2020-08-05 05:30:00|0E-14            |79.09882325040374|100     |79.83007081928720|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:29:25.432|16          |2020-08-05 05:30:00|0E-14            |74.72294172166815|100     |76.05085199350985|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:34:40.415|17          |2020-08-05 05:30:00|0E-14            |78.06235033524703|100     |78.36705025855920|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:41:23.633|18          |2020-08-05 05:30:00|0E-14            |78.71683328488820|100     |80.45610125569267|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:50:54.911|19          |2020-08-05 05:30:00|0E-14            |79.17169989748359|100     |80.14798230305898|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 17:10:20,584 :: INFO :: main :: 78 :: Processing eod trade0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 09:09:24.38 |30          |2020-08-05 05:30:00|75.87925515076047|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
only showing top 3 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 17:10:24,166 :: INFO :: main :: 78 :: Processing eod quote0 + 1) / 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |bid_pr           |bid_size|ask_pr           |ask_size|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|76.10016521142818|100     |77.96479759087470|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|75.44372945251948|100     |75.94452858561046|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|78.84798564828422|100     |80.69114407667608|100     |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
only showing top 3 rows

root
 |-- trade_dt: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- event_tm: timestamp (nullable = true)
 |-- event_seq_nb: integer (nullable = true)
 |-- arrival_tm: timestamp (nullable = true)
 |-- bid_pr: decimal(17,14) (nullable = true)
 |-- bid_size: integer (nullable = true)
 |-- ask_pr: decimal(17,14) (nullable = true)
 |-- ask_size: integer (nullable = true)

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 17:10:27,857 :: INFO :: main :: 78 :: Processing analytical_quote/ 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 17:10:31 WARN HintErrorLogger: Count not find relation 'prev_temp_last_trade' specified in hint 'BROADCAST(prev_temp_last_trade)'.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2020-08-06:>  (0 + 2) / 2][Stage 272:>  (0 + 1) / 1][Stage 273:>  (0 + 1) / 2]
2021-03-23 17:10:34,340 :: INFO :: <module> :: 108 :: Updating the job status in the POSTGRES Table
2021-03-23 17:10:34,347 :: INFO :: <module> :: 112 :: Updating the job status
Job ID Assigned: 5
2021-03-23 17:10:36,793 :: INFO :: get_db_connection :: 100 ::  Successfully connected to postgres DB
2021-03-23 17:10:36,794 :: INFO :: update_job_status :: 41 :: Trying to create table spark_job
2021-03-23 17:10:37,201 :: INFO :: update_job_status :: 51 :: Created Table spark_job for job_id: 5
2021-03-23 17:10:37,202 :: INFO :: update_job_status :: 53 ::  Updating status of the job in the table
2021-03-23 17:10:37,278 :: INFO :: update_job_status :: 62 :: Printing the output of spark job table spark_job
2021-03-23 17:10:37,314 :: INFO :: update_job_status :: 68 :: Data row = (5, analytical_etl, success, 2020-08-06)

(dbconnect) C:\Step_Five_Pipeline_Orchestration\src>SUCCESS: The process with PID 22824 (child process of PID 12280) has been terminated.
SUCCESS: The process with PID 12280 (child process of PID 17056) has been terminated.
SUCCESS: The process with PID 17056 (child process of PID 8020) has been terminated.
cd ..

(dbconnect) C:\Step_Five_Pipeline_Orchestration>cd ..

(dbconnect) C:\>cd Pipelineorchestration

(dbconnect) C:\Pipelineorchestration>python etldriver.py
python: can't open file 'etldriver.py': [Errno 2] No such file or directory

(dbconnect) C:\Pipelineorchestration>cd Pipelineorchestration

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
Traceback (most recent call last):
  File "etldriver.py", line 11, in <module>
    from Tracker import Tracker
ModuleNotFoundError: No module named 'Tracker'

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
21/03/23 19:00:13 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 19:00:13 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 19:00:14 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 19:00:26 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:00:31,675 :: INFO :: main :: 78 :: Processing raw csv
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:34:51.505|1           |2020-08-05 05:30:00|0E-14            |75.30254839137037|100     |75.35916738004924|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:40:52.586|2           |2020-08-05 05:30:00|0E-14            |77.20874619466693|100     |78.90918015646369|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:50:04.681|3           |2020-08-05 05:30:00|0E-14            |77.15973273251218|100     |77.33204694110470|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:57:46.343|4           |2020-08-05 05:30:00|0E-14            |79.29977331004093|100     |80.08399307353596|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:06:50.886|5           |2020-08-05 05:30:00|0E-14            |77.86349512170780|100     |78.30821537434917|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:11:43.839|6           |2020-08-05 05:30:00|0E-14            |78.74799689143143|100     |80.32905299746953|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:17:02.044|7           |2020-08-05 05:30:00|0E-14            |77.16837620945849|100     |77.97598027909252|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:23:58.216|8           |2020-08-05 05:30:00|0E-14            |78.06551496692607|100     |78.80516026628197|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:31:40.057|9           |2020-08-05 05:30:00|0E-14            |76.69653634240801|100     |78.56942375735030|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 06:37:21.581|10          |2020-08-05 05:30:00|79.19488165597565|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:45:27.205|11          |2020-08-05 05:30:00|0E-14            |75.10473622642823|100     |77.09656190920616|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:54:06.198|12          |2020-08-05 05:30:00|0E-14            |74.52147919052219|100     |75.66916329143558|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:03:24.882|13          |2020-08-05 05:30:00|0E-14            |75.16876091805237|100     |76.70697764844876|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:12:54.259|14          |2020-08-05 05:30:00|0E-14            |74.56633254759171|100     |74.62137517521543|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:19:55.013|15          |2020-08-05 05:30:00|0E-14            |74.49803365619901|100     |76.47591167094056|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:27:34.304|16          |2020-08-05 05:30:00|0E-14            |75.22889133048018|100     |76.14368647113133|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:35:18.534|17          |2020-08-05 05:30:00|0E-14            |76.62791946609745|100     |76.99149298587172|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:42:42.976|18          |2020-08-05 05:30:00|0E-14            |77.09466818643507|100     |78.15967343099572|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:51:08.791|19          |2020-08-05 05:30:00|0E-14            |78.33536506091860|100     |79.39139072379258|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 07:56:13.086|20          |2020-08-05 05:30:00|76.49092501585646|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:00:44,061 :: INFO :: main :: 78 :: Processing raw json(0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|0E-14            |76.10016521142818|100     |77.96479759087470|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|0E-14            |75.44372945251948|100     |75.94452858561046|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|0E-14            |78.84798564828422|100     |80.69114407667608|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:53:09.803|4           |2020-08-05 05:30:00|0E-14            |74.98336890552693|100     |76.16256530811053|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:00:10.866|5           |2020-08-05 05:30:00|0E-14            |76.71408448666702|100     |77.85512785142082|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:05:24.344|6           |2020-08-05 05:30:00|0E-14            |76.78900747031288|100     |77.79982571852163|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:13:59.224|7           |2020-08-05 05:30:00|0E-14            |76.37099394549293|100     |76.94631910510188|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:21:43.76 |8           |2020-08-05 05:30:00|0E-14            |77.32601214334609|100     |77.65017757988643|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:30:33.547|9           |2020-08-05 05:30:00|0E-14            |77.11395059665263|100     |77.52985832434904|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:45:54.754|11          |2020-08-05 05:30:00|0E-14            |77.69893211260312|100     |79.18604684163077|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:54:34.696|12          |2020-08-05 05:30:00|0E-14            |75.09529363658093|100     |75.83132049866276|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:02:08.291|13          |2020-08-05 05:30:00|0E-14            |77.76547178321442|100     |79.41345232512326|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:11:36.644|14          |2020-08-05 05:30:00|0E-14            |76.39994032672179|100     |76.83733213626446|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:19:53.959|15          |2020-08-05 05:30:00|0E-14            |79.09882325040374|100     |79.83007081928720|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:29:25.432|16          |2020-08-05 05:30:00|0E-14            |74.72294172166815|100     |76.05085199350985|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:34:40.415|17          |2020-08-05 05:30:00|0E-14            |78.06235033524703|100     |78.36705025855920|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:41:23.633|18          |2020-08-05 05:30:00|0E-14            |78.71683328488820|100     |80.45610125569267|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:50:54.911|19          |2020-08-05 05:30:00|0E-14            |79.17169989748359|100     |80.14798230305898|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:00:46,486 :: INFO :: main :: 78 :: Processing eod trade0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 09:09:24.38 |30          |2020-08-05 05:30:00|75.87925515076047|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
only showing top 3 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:00:59,646 :: INFO :: main :: 78 :: Processing eod quote0 + 1) / 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |bid_pr           |bid_size|ask_pr           |ask_size|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|76.10016521142818|100     |77.96479759087470|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|75.44372945251948|100     |75.94452858561046|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|78.84798564828422|100     |80.69114407667608|100     |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
only showing top 3 rows

root
 |-- trade_dt: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- event_tm: timestamp (nullable = true)
 |-- event_seq_nb: integer (nullable = true)
 |-- arrival_tm: timestamp (nullable = true)
 |-- bid_pr: decimal(17,14) (nullable = true)
 |-- bid_size: integer (nullable = true)
 |-- ask_pr: decimal(17,14) (nullable = true)
 |-- ask_size: integer (nullable = true)

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:01:04,746 :: INFO :: main :: 78 :: Processing analytical_quote/ 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 19:01:09 WARN HintErrorLogger: Count not find relation 'prev_temp_last_trade' specified in hint 'BROADCAST(prev_temp_last_trade)'.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
path dbfs:/trade_analytical/date=2020-08-06 already exists.;
2021-03-23 19:01:11,077 :: ERROR :: main :: 82 ::  Error encountered while processing analytical_quote
2021-03-23 19:01:11,088 :: INFO :: <module> :: 107 :: Updating the job status in the POSTGRES Table
2021-03-23 19:01:11,088 :: INFO :: <module> :: 110 :: Updating the job status
Job ID Assigned: 8
2021-03-23 19:01:12,631 :: INFO :: get_db_connection :: 97 ::  Successfully connected to postgres DB
2021-03-23 19:01:12,631 :: INFO :: update_job_status :: 41 :: Trying to create table spark_job
2021-03-23 19:01:12,948 :: INFO :: update_job_status :: 51 :: Created Table spark_job for job_id: 8
2021-03-23 19:01:12,948 :: INFO :: update_job_status :: 53 ::  Updating status of the job in the table
2021-03-23 19:01:13,013 :: INFO :: update_job_status :: 62 :: Printing the output of spark job table spark_job
2021-03-23 19:01:13,047 :: INFO :: update_job_status :: 68 :: Data row = (8, analytical_etl, success, 2020-08-06)
2021-03-23 19:01:13,047 :: INFO :: <module> :: 116 :: ALL DONE!


(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>SUCCESS: The process with PID 12132 (child process of PID 2684) has been terminated.
SUCCESS: The process with PID 2684 (child process of PID 22332) has been terminated.
SUCCESS: The process with PID 22332 (child process of PID 9492) has been terminated.
python etldriver.py
Traceback (most recent call last):
  File "etldriver.py", line 11, in <module>
    from Tracker import Tracker
ModuleNotFoundError: No module named 'Tracker'

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
21/03/23 19:18:46 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 19:18:46 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 19:18:48 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 19:19:00 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:19:04,194 :: INFO :: main :: 78 :: Processing raw csv
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:34:51.505|1           |2020-08-05 05:30:00|0E-14            |75.30254839137037|100     |75.35916738004924|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:40:52.586|2           |2020-08-05 05:30:00|0E-14            |77.20874619466693|100     |78.90918015646369|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:50:04.681|3           |2020-08-05 05:30:00|0E-14            |77.15973273251218|100     |77.33204694110470|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:57:46.343|4           |2020-08-05 05:30:00|0E-14            |79.29977331004093|100     |80.08399307353596|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:06:50.886|5           |2020-08-05 05:30:00|0E-14            |77.86349512170780|100     |78.30821537434917|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:11:43.839|6           |2020-08-05 05:30:00|0E-14            |78.74799689143143|100     |80.32905299746953|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:17:02.044|7           |2020-08-05 05:30:00|0E-14            |77.16837620945849|100     |77.97598027909252|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:23:58.216|8           |2020-08-05 05:30:00|0E-14            |78.06551496692607|100     |78.80516026628197|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:31:40.057|9           |2020-08-05 05:30:00|0E-14            |76.69653634240801|100     |78.56942375735030|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 06:37:21.581|10          |2020-08-05 05:30:00|79.19488165597565|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:45:27.205|11          |2020-08-05 05:30:00|0E-14            |75.10473622642823|100     |77.09656190920616|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:54:06.198|12          |2020-08-05 05:30:00|0E-14            |74.52147919052219|100     |75.66916329143558|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:03:24.882|13          |2020-08-05 05:30:00|0E-14            |75.16876091805237|100     |76.70697764844876|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:12:54.259|14          |2020-08-05 05:30:00|0E-14            |74.56633254759171|100     |74.62137517521543|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:19:55.013|15          |2020-08-05 05:30:00|0E-14            |74.49803365619901|100     |76.47591167094056|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:27:34.304|16          |2020-08-05 05:30:00|0E-14            |75.22889133048018|100     |76.14368647113133|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:35:18.534|17          |2020-08-05 05:30:00|0E-14            |76.62791946609745|100     |76.99149298587172|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:42:42.976|18          |2020-08-05 05:30:00|0E-14            |77.09466818643507|100     |78.15967343099572|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:51:08.791|19          |2020-08-05 05:30:00|0E-14            |78.33536506091860|100     |79.39139072379258|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 07:56:13.086|20          |2020-08-05 05:30:00|76.49092501585646|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:19:17,461 :: INFO :: main :: 78 :: Processing raw json(0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|0E-14            |76.10016521142818|100     |77.96479759087470|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|0E-14            |75.44372945251948|100     |75.94452858561046|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|0E-14            |78.84798564828422|100     |80.69114407667608|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:53:09.803|4           |2020-08-05 05:30:00|0E-14            |74.98336890552693|100     |76.16256530811053|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:00:10.866|5           |2020-08-05 05:30:00|0E-14            |76.71408448666702|100     |77.85512785142082|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:05:24.344|6           |2020-08-05 05:30:00|0E-14            |76.78900747031288|100     |77.79982571852163|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:13:59.224|7           |2020-08-05 05:30:00|0E-14            |76.37099394549293|100     |76.94631910510188|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:21:43.76 |8           |2020-08-05 05:30:00|0E-14            |77.32601214334609|100     |77.65017757988643|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:30:33.547|9           |2020-08-05 05:30:00|0E-14            |77.11395059665263|100     |77.52985832434904|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:45:54.754|11          |2020-08-05 05:30:00|0E-14            |77.69893211260312|100     |79.18604684163077|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:54:34.696|12          |2020-08-05 05:30:00|0E-14            |75.09529363658093|100     |75.83132049866276|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:02:08.291|13          |2020-08-05 05:30:00|0E-14            |77.76547178321442|100     |79.41345232512326|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:11:36.644|14          |2020-08-05 05:30:00|0E-14            |76.39994032672179|100     |76.83733213626446|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:19:53.959|15          |2020-08-05 05:30:00|0E-14            |79.09882325040374|100     |79.83007081928720|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:29:25.432|16          |2020-08-05 05:30:00|0E-14            |74.72294172166815|100     |76.05085199350985|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:34:40.415|17          |2020-08-05 05:30:00|0E-14            |78.06235033524703|100     |78.36705025855920|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:41:23.633|18          |2020-08-05 05:30:00|0E-14            |78.71683328488820|100     |80.45610125569267|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:50:54.911|19          |2020-08-05 05:30:00|0E-14            |79.17169989748359|100     |80.14798230305898|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:19:19,758 :: INFO :: main :: 78 :: Processing eod trade0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 09:09:24.38 |30          |2020-08-05 05:30:00|75.87925515076047|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
only showing top 3 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:19:32,186 :: INFO :: main :: 78 :: Processing eod quote0 + 1) / 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |bid_pr           |bid_size|ask_pr           |ask_size|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|76.10016521142818|100     |77.96479759087470|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|75.44372945251948|100     |75.94452858561046|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|78.84798564828422|100     |80.69114407667608|100     |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
only showing top 3 rows

root
 |-- trade_dt: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- event_tm: timestamp (nullable = true)
 |-- event_seq_nb: integer (nullable = true)
 |-- arrival_tm: timestamp (nullable = true)
 |-- bid_pr: decimal(17,14) (nullable = true)
 |-- bid_size: integer (nullable = true)
 |-- ask_pr: decimal(17,14) (nullable = true)
 |-- ask_size: integer (nullable = true)

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:19:37,030 :: INFO :: main :: 78 :: Processing analytical_quote/ 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 19:19:41 WARN HintErrorLogger: Count not find relation 'prev_temp_last_trade' specified in hint 'BROADCAST(prev_temp_last_trade)'.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:19:46,660 :: INFO :: <module> :: 107 :: Updating the job status in the POSTGRES Table
2021-03-23 19:19:46,660 :: INFO :: <module> :: 110 :: Updating the job status
Job ID Assigned: 4
2021-03-23 19:19:48,770 :: INFO :: get_db_connection :: 97 ::  Successfully connected to postgres DB
2021-03-23 19:19:48,771 :: INFO :: update_job_status :: 41 :: Trying to create table spark_job
2021-03-23 19:19:49,125 :: INFO :: update_job_status :: 51 :: Created Table spark_job for job_id: 4
2021-03-23 19:19:49,126 :: INFO :: update_job_status :: 53 ::  Updating status of the job in the table
2021-03-23 19:19:49,183 :: INFO :: update_job_status :: 62 :: Printing the output of spark job table spark_job
2021-03-23 19:19:49,219 :: INFO :: update_job_status :: 68 :: Data row = (4, analytical_etl, success, 2020-08-06)
2021-03-23 19:19:49,219 :: INFO :: <module> :: 116 :: ALL DONE!


(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>SUCCESS: The process with PID 1676 (child process of PID 18004) has been terminated.
SUCCESS: The process with PID 18004 (child process of PID 20324) has been terminated.
SUCCESS: The process with PID 20324 (child process of PID 23240) has been terminated.
python etldriver.py
Traceback (most recent call last):
  File "etldriver.py", line 8, in <module>
    from Pipelineorchestration.etl.etl_load import ETLLoad
ModuleNotFoundError: No module named 'Pipelineorchestration'

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
Traceback (most recent call last):
  File "etldriver.py", line 8, in <module>
    from Pipelineorchestration.etl.etl_load import ETLLoad
ModuleNotFoundError: No module named 'Pipelineorchestration'

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
Traceback (most recent call last):
  File "etldriver.py", line 8, in <module>
    from .etl.etl_load import ETLLoad
ImportError: attempted relative import with no known parent package

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
Traceback (most recent call last):
  File "etldriver.py", line 8, in <module>
    from Pipelineorchestration.etl import etl_load
ModuleNotFoundError: No module named 'Pipelineorchestration'

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
Traceback (most recent call last):
  File "etldriver.py", line 8, in <module>
    from Pipelineorchestration.etl.etl_load import ETLLoad
ModuleNotFoundError: No module named 'Pipelineorchestration'

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
Traceback (most recent call last):
  File "etldriver.py", line 10, in <module>
    from Pipelineorchestration.eod_load.eod_load import ETLLoad
ModuleNotFoundError: No module named 'Pipelineorchestration'

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
Traceback (most recent call last):
  File "etldriver.py", line 10, in <module>
    from ..eod_load.eod_load import ETLLoad
ImportError: attempted relative import with no known parent package

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
Traceback (most recent call last):
  File "etldriver.py", line 10, in <module>
    from eod_load.eod_load import ETLLoad
ModuleNotFoundError: No module named 'eod_load'

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
Traceback (most recent call last):
  File "etldriver.py", line 10, in <module>
    from eod_load import ETLLoad
ModuleNotFoundError: No module named 'eod_load'

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
21/03/23 19:56:07 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 19:56:07 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 19:56:10 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
Traceback (most recent call last):
  File "etldriver.py", line 111, in <module>
    main(**args)
  File "etldriver.py", line 56, in main
    pre_process= Preprocess(spark,spark_context)
NameError: name 'Preprocess' is not defined

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>SUCCESS: The process with PID 19044 (child process of PID 10028) has been terminated.
SUCCESS: The process with PID 10028 (child process of PID 11620) has been terminated.
SUCCESS: The process with PID 11620 (child process of PID 7128) has been terminated.
python etldriver.py
21/03/23 19:57:32 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 19:57:32 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 19:57:35 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
21/03/23 19:57:46 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:57:56,038 :: INFO :: main :: 86 :: Processing raw csv
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:34:51.505|1           |2020-08-05 05:30:00|0E-14            |75.30254839137037|100     |75.35916738004924|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:40:52.586|2           |2020-08-05 05:30:00|0E-14            |77.20874619466693|100     |78.90918015646369|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:50:04.681|3           |2020-08-05 05:30:00|0E-14            |77.15973273251218|100     |77.33204694110470|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:57:46.343|4           |2020-08-05 05:30:00|0E-14            |79.29977331004093|100     |80.08399307353596|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:06:50.886|5           |2020-08-05 05:30:00|0E-14            |77.86349512170780|100     |78.30821537434917|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:11:43.839|6           |2020-08-05 05:30:00|0E-14            |78.74799689143143|100     |80.32905299746953|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:17:02.044|7           |2020-08-05 05:30:00|0E-14            |77.16837620945849|100     |77.97598027909252|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:23:58.216|8           |2020-08-05 05:30:00|0E-14            |78.06551496692607|100     |78.80516026628197|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:31:40.057|9           |2020-08-05 05:30:00|0E-14            |76.69653634240801|100     |78.56942375735030|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 06:37:21.581|10          |2020-08-05 05:30:00|79.19488165597565|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:45:27.205|11          |2020-08-05 05:30:00|0E-14            |75.10473622642823|100     |77.09656190920616|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:54:06.198|12          |2020-08-05 05:30:00|0E-14            |74.52147919052219|100     |75.66916329143558|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:03:24.882|13          |2020-08-05 05:30:00|0E-14            |75.16876091805237|100     |76.70697764844876|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:12:54.259|14          |2020-08-05 05:30:00|0E-14            |74.56633254759171|100     |74.62137517521543|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:19:55.013|15          |2020-08-05 05:30:00|0E-14            |74.49803365619901|100     |76.47591167094056|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:27:34.304|16          |2020-08-05 05:30:00|0E-14            |75.22889133048018|100     |76.14368647113133|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:35:18.534|17          |2020-08-05 05:30:00|0E-14            |76.62791946609745|100     |76.99149298587172|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:42:42.976|18          |2020-08-05 05:30:00|0E-14            |77.09466818643507|100     |78.15967343099572|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:51:08.791|19          |2020-08-05 05:30:00|0E-14            |78.33536506091860|100     |79.39139072379258|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 07:56:13.086|20          |2020-08-05 05:30:00|76.49092501585646|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:58:09,796 :: INFO :: main :: 86 :: Processing raw json(0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|0E-14            |76.10016521142818|100     |77.96479759087470|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|0E-14            |75.44372945251948|100     |75.94452858561046|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|0E-14            |78.84798564828422|100     |80.69114407667608|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:53:09.803|4           |2020-08-05 05:30:00|0E-14            |74.98336890552693|100     |76.16256530811053|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:00:10.866|5           |2020-08-05 05:30:00|0E-14            |76.71408448666702|100     |77.85512785142082|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:05:24.344|6           |2020-08-05 05:30:00|0E-14            |76.78900747031288|100     |77.79982571852163|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:13:59.224|7           |2020-08-05 05:30:00|0E-14            |76.37099394549293|100     |76.94631910510188|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:21:43.76 |8           |2020-08-05 05:30:00|0E-14            |77.32601214334609|100     |77.65017757988643|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:30:33.547|9           |2020-08-05 05:30:00|0E-14            |77.11395059665263|100     |77.52985832434904|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:45:54.754|11          |2020-08-05 05:30:00|0E-14            |77.69893211260312|100     |79.18604684163077|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:54:34.696|12          |2020-08-05 05:30:00|0E-14            |75.09529363658093|100     |75.83132049866276|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:02:08.291|13          |2020-08-05 05:30:00|0E-14            |77.76547178321442|100     |79.41345232512326|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:11:36.644|14          |2020-08-05 05:30:00|0E-14            |76.39994032672179|100     |76.83733213626446|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:19:53.959|15          |2020-08-05 05:30:00|0E-14            |79.09882325040374|100     |79.83007081928720|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:29:25.432|16          |2020-08-05 05:30:00|0E-14            |74.72294172166815|100     |76.05085199350985|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:34:40.415|17          |2020-08-05 05:30:00|0E-14            |78.06235033524703|100     |78.36705025855920|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:41:23.633|18          |2020-08-05 05:30:00|0E-14            |78.71683328488820|100     |80.45610125569267|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:50:54.911|19          |2020-08-05 05:30:00|0E-14            |79.17169989748359|100     |80.14798230305898|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:58:12,424 :: INFO :: main :: 86 :: Processing eod trade0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 09:09:24.38 |30          |2020-08-05 05:30:00|75.87925515076047|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
only showing top 3 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:58:25,801 :: INFO :: main :: 86 :: Processing eod quote0 + 1) / 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |bid_pr           |bid_size|ask_pr           |ask_size|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|76.10016521142818|100     |77.96479759087470|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|75.44372945251948|100     |75.94452858561046|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|78.84798564828422|100     |80.69114407667608|100     |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
only showing top 3 rows

root
 |-- trade_dt: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- event_tm: timestamp (nullable = true)
 |-- event_seq_nb: integer (nullable = true)
 |-- arrival_tm: timestamp (nullable = true)
 |-- bid_pr: decimal(17,14) (nullable = true)
 |-- bid_size: integer (nullable = true)
 |-- ask_pr: decimal(17,14) (nullable = true)
 |-- ask_size: integer (nullable = true)

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:58:30,244 :: INFO :: main :: 86 :: Processing analytical_quote/ 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 19:58:35 WARN HintErrorLogger: Count not find relation 'prev_temp_last_trade' specified in hint 'BROADCAST(prev_temp_last_trade)'.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 19:58:39,870 :: INFO :: <module> :: 115 :: Updating the job status in the POSTGRES Table
2021-03-23 19:58:39,871 :: INFO :: <module> :: 118 :: Updating the job status
Job ID Assigned: 1
2021-03-23 19:58:41,642 :: INFO :: get_db_connection :: 97 ::  Successfully connected to postgres DB
2021-03-23 19:58:41,643 :: INFO :: update_job_status :: 41 :: Trying to create table spark_job
2021-03-23 19:58:42,050 :: INFO :: update_job_status :: 51 :: Created Table spark_job for job_id: 1
2021-03-23 19:58:42,052 :: INFO :: update_job_status :: 53 ::  Updating status of the job in the table
2021-03-23 19:58:42,116 :: INFO :: update_job_status :: 62 :: Printing the output of spark job table spark_job
2021-03-23 19:58:42,154 :: INFO :: update_job_status :: 68 :: Data row = (1, analytical_etl, success, 2020-08-06)
2021-03-23 19:58:42,155 :: INFO :: <module> :: 124 :: ALL DONE!


(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>SUCCESS: The process with PID 15344 (child process of PID 2356) has been terminated.
SUCCESS: The process with PID 2356 (child process of PID 10188) has been terminated.
SUCCESS: The process with PID 10188 (child process of PID 11840) has been terminated.
python etldriver.py
Traceback (most recent call last):
  File "etldriver.py", line 12, in <module>
    from eod_load.etl_load import ETLLoad
  File "C:\Pipelineorchestration\Pipelineorchestration\eod_load\etl_load.py", line 18, in <module>
    config.read_file(open(f"{Path(__file__).parents[0]}/config.cfg"))
FileNotFoundError: [Errno 2] No such file or directory: 'C:\\Pipelineorchestration\\Pipelineorchestration\\eod_load/config.cfg'

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
Traceback (most recent call last):
  File "etldriver.py", line 12, in <module>
    from eod_load.etl_load import ETLLoad
  File "C:\Pipelineorchestration\Pipelineorchestration\eod_load\etl_load.py", line 18, in <module>
    config.read_file(open(f"{Path(__file__).parents[0]}/Pipelineorchestration/config.cfg"))
FileNotFoundError: [Errno 2] No such file or directory: 'C:\\Pipelineorchestration\\Pipelineorchestration\\eod_load/Pipelineorchestration/config.cfg'

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
21/03/23 20:13:03 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 20:13:03 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 20:13:06 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 20:13:22 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 20:13:25,904 :: INFO :: main :: 90 :: Processing raw csv
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:34:51.505|1           |2020-08-05 05:30:00|0E-14            |75.30254839137037|100     |75.35916738004924|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:40:52.586|2           |2020-08-05 05:30:00|0E-14            |77.20874619466693|100     |78.90918015646369|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:50:04.681|3           |2020-08-05 05:30:00|0E-14            |77.15973273251218|100     |77.33204694110470|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:57:46.343|4           |2020-08-05 05:30:00|0E-14            |79.29977331004093|100     |80.08399307353596|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:06:50.886|5           |2020-08-05 05:30:00|0E-14            |77.86349512170780|100     |78.30821537434917|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:11:43.839|6           |2020-08-05 05:30:00|0E-14            |78.74799689143143|100     |80.32905299746953|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:17:02.044|7           |2020-08-05 05:30:00|0E-14            |77.16837620945849|100     |77.97598027909252|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:23:58.216|8           |2020-08-05 05:30:00|0E-14            |78.06551496692607|100     |78.80516026628197|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:31:40.057|9           |2020-08-05 05:30:00|0E-14            |76.69653634240801|100     |78.56942375735030|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 06:37:21.581|10          |2020-08-05 05:30:00|79.19488165597565|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:45:27.205|11          |2020-08-05 05:30:00|0E-14            |75.10473622642823|100     |77.09656190920616|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:54:06.198|12          |2020-08-05 05:30:00|0E-14            |74.52147919052219|100     |75.66916329143558|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:03:24.882|13          |2020-08-05 05:30:00|0E-14            |75.16876091805237|100     |76.70697764844876|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:12:54.259|14          |2020-08-05 05:30:00|0E-14            |74.56633254759171|100     |74.62137517521543|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:19:55.013|15          |2020-08-05 05:30:00|0E-14            |74.49803365619901|100     |76.47591167094056|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:27:34.304|16          |2020-08-05 05:30:00|0E-14            |75.22889133048018|100     |76.14368647113133|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:35:18.534|17          |2020-08-05 05:30:00|0E-14            |76.62791946609745|100     |76.99149298587172|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:42:42.976|18          |2020-08-05 05:30:00|0E-14            |77.09466818643507|100     |78.15967343099572|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:51:08.791|19          |2020-08-05 05:30:00|0E-14            |78.33536506091860|100     |79.39139072379258|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 07:56:13.086|20          |2020-08-05 05:30:00|76.49092501585646|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 20:13:31,481 :: INFO :: main :: 90 :: Processing raw json(0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|0E-14            |76.10016521142818|100     |77.96479759087470|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|0E-14            |75.44372945251948|100     |75.94452858561046|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|0E-14            |78.84798564828422|100     |80.69114407667608|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:53:09.803|4           |2020-08-05 05:30:00|0E-14            |74.98336890552693|100     |76.16256530811053|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:00:10.866|5           |2020-08-05 05:30:00|0E-14            |76.71408448666702|100     |77.85512785142082|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:05:24.344|6           |2020-08-05 05:30:00|0E-14            |76.78900747031288|100     |77.79982571852163|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:13:59.224|7           |2020-08-05 05:30:00|0E-14            |76.37099394549293|100     |76.94631910510188|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:21:43.76 |8           |2020-08-05 05:30:00|0E-14            |77.32601214334609|100     |77.65017757988643|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:30:33.547|9           |2020-08-05 05:30:00|0E-14            |77.11395059665263|100     |77.52985832434904|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:45:54.754|11          |2020-08-05 05:30:00|0E-14            |77.69893211260312|100     |79.18604684163077|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:54:34.696|12          |2020-08-05 05:30:00|0E-14            |75.09529363658093|100     |75.83132049866276|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:02:08.291|13          |2020-08-05 05:30:00|0E-14            |77.76547178321442|100     |79.41345232512326|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:11:36.644|14          |2020-08-05 05:30:00|0E-14            |76.39994032672179|100     |76.83733213626446|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:19:53.959|15          |2020-08-05 05:30:00|0E-14            |79.09882325040374|100     |79.83007081928720|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:29:25.432|16          |2020-08-05 05:30:00|0E-14            |74.72294172166815|100     |76.05085199350985|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:34:40.415|17          |2020-08-05 05:30:00|0E-14            |78.06235033524703|100     |78.36705025855920|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:41:23.633|18          |2020-08-05 05:30:00|0E-14            |78.71683328488820|100     |80.45610125569267|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:50:54.911|19          |2020-08-05 05:30:00|0E-14            |79.17169989748359|100     |80.14798230305898|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 20:13:34,081 :: INFO :: main :: 90 :: Processing eod trade0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 09:09:24.38 |30          |2020-08-05 05:30:00|75.87925515076047|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
only showing top 3 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 20:13:38,739 :: INFO :: main :: 90 :: Processing eod quote0 + 1) / 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |bid_pr           |bid_size|ask_pr           |ask_size|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|76.10016521142818|100     |77.96479759087470|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|75.44372945251948|100     |75.94452858561046|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|78.84798564828422|100     |80.69114407667608|100     |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
only showing top 3 rows

root
 |-- trade_dt: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- event_tm: timestamp (nullable = true)
 |-- event_seq_nb: integer (nullable = true)
 |-- arrival_tm: timestamp (nullable = true)
 |-- bid_pr: decimal(17,14) (nullable = true)
 |-- bid_size: integer (nullable = true)
 |-- ask_pr: decimal(17,14) (nullable = true)
 |-- ask_size: integer (nullable = true)

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 20:13:43,047 :: INFO :: main :: 90 :: Processing analytical_quote/ 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 20:13:46 WARN HintErrorLogger: Count not find relation 'prev_temp_last_trade' specified in hint 'BROADCAST(prev_temp_last_trade)'.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 20:13:50,242 :: INFO :: <module> :: 119 :: Updating the job status in the POSTGRES Table
2021-03-23 20:13:50,244 :: INFO :: <module> :: 122 :: Updating the job status
Job ID Assigned: 9
2021-03-23 20:13:52,596 :: INFO :: get_db_connection :: 99 ::  Successfully connected to postgres DB
2021-03-23 20:13:52,597 :: INFO :: update_job_status :: 43 :: Trying to create table spark_job
2021-03-23 20:13:53,005 :: INFO :: update_job_status :: 53 :: Created Table spark_job for job_id: 9
2021-03-23 20:13:53,006 :: INFO :: update_job_status :: 55 ::  Updating status of the job in the table
2021-03-23 20:13:53,078 :: INFO :: update_job_status :: 64 :: Printing the output of spark job table spark_job
2021-03-23 20:13:53,113 :: INFO :: update_job_status :: 70 :: Data row = (9, analytical_etl, success, 2020-08-06)
2021-03-23 20:13:53,115 :: INFO :: <module> :: 128 :: ALL DONE!


(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>SUCCESS: The process with PID 23544 (child process of PID 7104) has been terminated.
SUCCESS: The process with PID 7104 (child process of PID 15668) has been terminated.
SUCCESS: The process with PID 15668 (child process of PID 22176) has been terminated.
python etldriver.py
21/03/23 20:49:52 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 20:49:52 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 20:49:55 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
21/03/23 20:50:06 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 20:50:14,531 :: INFO :: send_command :: 1210 :: Error while receiving.
Traceback (most recent call last):
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 1200, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\pyspark\context.py", line 286, in signal_handler
    self.cancelAllJobs()
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\pyspark\context.py", line 1183, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 1305, in __call__
    answer, self.gateway_client, self.target_id, self.name)
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\pyspark\sql\utils.py", line 127, in deco
    return f(*a, **kw)
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\protocol.py", line 328, in get_return_value
    format(target_id, ".", name), value)
py4j.protocol.Py4JJavaError: An error occurred while calling o32.cancelAllJobs.
: java.lang.IllegalStateException: Cannot call methods on a stopped SparkContext.
This stopped SparkContext was created at:

org.apache.spark.api.java.JavaSparkContext.<init>(JavaSparkContext.scala:60)
sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
java.lang.reflect.Constructor.newInstance(Constructor.java:423)
py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:247)
py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:380)
py4j.Gateway.invoke(Gateway.java:250)
py4j.commands.ConstructorCommand.invokeConstructor(ConstructorCommand.java:80)
py4j.commands.ConstructorCommand.execute(ConstructorCommand.java:69)
py4j.GatewayConnection.run(GatewayConnection.java:251)
java.lang.Thread.run(Thread.java:748)

The currently active SparkContext was created at:

(No active SparkContext.)

        at org.apache.spark.SparkContext.assertNotStopped(SparkContext.scala:132)
        at org.apache.spark.SparkContext.cancelAllJobs(SparkContext.scala:2518)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
        at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:380)
        at py4j.Gateway.invoke(Gateway.java:295)
        at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
        at py4j.commands.CallCommand.execute(CallCommand.java:79)
        at py4j.GatewayConnection.run(GatewayConnection.java:251)
        at java.lang.Thread.run(Thread.java:748)

2021-03-23 20:50:14,554 :: ERROR :: send_command :: 1051 :: Exception while sending command.
Traceback (most recent call last):
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 1200, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\pyspark\context.py", line 286, in signal_handler
    self.cancelAllJobs()
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\pyspark\context.py", line 1183, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 1305, in __call__
    answer, self.gateway_client, self.target_id, self.name)
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\pyspark\sql\utils.py", line 127, in deco
    return f(*a, **kw)
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\protocol.py", line 328, in get_return_value
    format(target_id, ".", name), value)
py4j.protocol.Py4JJavaError: An error occurred while calling o32.cancelAllJobs.
: java.lang.IllegalStateException: Cannot call methods on a stopped SparkContext.
This stopped SparkContext was created at:

org.apache.spark.api.java.JavaSparkContext.<init>(JavaSparkContext.scala:60)
sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
java.lang.reflect.Constructor.newInstance(Constructor.java:423)
py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:247)
py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:380)
py4j.Gateway.invoke(Gateway.java:250)
py4j.commands.ConstructorCommand.invokeConstructor(ConstructorCommand.java:80)
py4j.commands.ConstructorCommand.execute(ConstructorCommand.java:69)
py4j.GatewayConnection.run(GatewayConnection.java:251)
java.lang.Thread.run(Thread.java:748)

The currently active SparkContext was created at:

(No active SparkContext.)

        at org.apache.spark.SparkContext.assertNotStopped(SparkContext.scala:132)
        at org.apache.spark.SparkContext.cancelAllJobs(SparkContext.scala:2518)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
        at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:380)
        at py4j.Gateway.invoke(Gateway.java:295)
        at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
        at py4j.commands.CallCommand.execute(CallCommand.java:79)
        at py4j.GatewayConnection.run(GatewayConnection.java:251)
        at java.lang.Thread.run(Thread.java:748)


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 1033, in send_command
    response = connection.send_command(command)
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 1212, in send_command
    "Error while receiving", e, proto.ERROR_ON_RECEIVE)
py4j.protocol.Py4JNetworkError: Error while receiving
Traceback (most recent call last):
  File "etldriver.py", line 116, in <module>
    main(**args)
  File "etldriver.py", line 73, in main
    spark.sql("DROP TABLE IF EXISTS temp_quote")
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\pyspark\sql\session.py", line 709, in sql
    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 1305, in __call__
    answer, self.gateway_client, self.target_id, self.name)
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\pyspark\sql\utils.py", line 127, in deco
    return f(*a, **kw)
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\protocol.py", line 336, in get_return_value
    format(target_id, ".", name))
py4j.protocol.Py4JError: An error occurred while calling o22.sql
SUCCESS: The process with PID 21492 (child process of PID 10356) has been terminated.
SUCCESS: The process with PID 10356 (child process of PID 1876) has been terminated.
SUCCESS: The process with PID 1876 (child process of PID 4376) has been terminated.
2021-03-23 20:50:15,007 :: INFO :: send_command :: 1210 :: Error while receiving.
Traceback (most recent call last):
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 1200, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\socket.py", line 589, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2021-03-23 20:50:15,013 :: ERROR :: send_command :: 1051 :: Exception while sending command.
Traceback (most recent call last):
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 1200, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\socket.py", line 589, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 1033, in send_command
    response = connection.send_command(command)
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 1212, in send_command
    "Error while receiving", e, proto.ERROR_ON_RECEIVE)
py4j.protocol.Py4JNetworkError: Error while receiving
2021-03-23 20:50:17,057 :: ERROR :: start :: 1126 :: An error occurred while trying to connect to the Java server (127.0.0.1:56230)
Traceback (most recent call last):
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 977, in _get_connection
    connection = self.deque.pop()
IndexError: pop from an empty deque

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 1115, in start
    self.socket.connect((self.address, self.port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it
2021-03-23 20:50:19,110 :: ERROR :: start :: 1126 :: An error occurred while trying to connect to the Java server (127.0.0.1:56230)
Traceback (most recent call last):
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 977, in _get_connection
    connection = self.deque.pop()
IndexError: pop from an empty deque

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 1115, in start
    self.socket.connect((self.address, self.port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it
2021-03-23 20:50:21,142 :: ERROR :: start :: 1126 :: An error occurred while trying to connect to the Java server (127.0.0.1:56230)
Traceback (most recent call last):
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 977, in _get_connection
    connection = self.deque.pop()
IndexError: pop from an empty deque

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\yogit\anaconda3\envs\dbconnect\lib\site-packages\py4j\java_gateway.py", line 1115, in start
    self.socket.connect((self.address, self.port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>^X
'' is not recognized as an internal or external command,
operable program or batch file.

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>
(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>
(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>
(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>
(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
21/03/23 20:57:11 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 20:57:11 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 20:57:15 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
21/03/23 20:57:28 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 20:57:34,130 :: INFO :: main :: 98 :: Processing raw csv
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:34:51.505|1           |2020-08-05 05:30:00|0E-14            |75.30254839137037|100     |75.35916738004924|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:40:52.586|2           |2020-08-05 05:30:00|0E-14            |77.20874619466693|100     |78.90918015646369|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:50:04.681|3           |2020-08-05 05:30:00|0E-14            |77.15973273251218|100     |77.33204694110470|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:57:46.343|4           |2020-08-05 05:30:00|0E-14            |79.29977331004093|100     |80.08399307353596|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:06:50.886|5           |2020-08-05 05:30:00|0E-14            |77.86349512170780|100     |78.30821537434917|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:11:43.839|6           |2020-08-05 05:30:00|0E-14            |78.74799689143143|100     |80.32905299746953|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:17:02.044|7           |2020-08-05 05:30:00|0E-14            |77.16837620945849|100     |77.97598027909252|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:23:58.216|8           |2020-08-05 05:30:00|0E-14            |78.06551496692607|100     |78.80516026628197|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:31:40.057|9           |2020-08-05 05:30:00|0E-14            |76.69653634240801|100     |78.56942375735030|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 06:37:21.581|10          |2020-08-05 05:30:00|79.19488165597565|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:45:27.205|11          |2020-08-05 05:30:00|0E-14            |75.10473622642823|100     |77.09656190920616|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:54:06.198|12          |2020-08-05 05:30:00|0E-14            |74.52147919052219|100     |75.66916329143558|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:03:24.882|13          |2020-08-05 05:30:00|0E-14            |75.16876091805237|100     |76.70697764844876|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:12:54.259|14          |2020-08-05 05:30:00|0E-14            |74.56633254759171|100     |74.62137517521543|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:19:55.013|15          |2020-08-05 05:30:00|0E-14            |74.49803365619901|100     |76.47591167094056|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:27:34.304|16          |2020-08-05 05:30:00|0E-14            |75.22889133048018|100     |76.14368647113133|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:35:18.534|17          |2020-08-05 05:30:00|0E-14            |76.62791946609745|100     |76.99149298587172|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:42:42.976|18          |2020-08-05 05:30:00|0E-14            |77.09466818643507|100     |78.15967343099572|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:51:08.791|19          |2020-08-05 05:30:00|0E-14            |78.33536506091860|100     |79.39139072379258|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 07:56:13.086|20          |2020-08-05 05:30:00|76.49092501585646|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 20:57:48,626 :: INFO :: main :: 98 :: Processing raw json(0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|0E-14            |76.10016521142818|100     |77.96479759087470|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|0E-14            |75.44372945251948|100     |75.94452858561046|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|0E-14            |78.84798564828422|100     |80.69114407667608|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:53:09.803|4           |2020-08-05 05:30:00|0E-14            |74.98336890552693|100     |76.16256530811053|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:00:10.866|5           |2020-08-05 05:30:00|0E-14            |76.71408448666702|100     |77.85512785142082|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:05:24.344|6           |2020-08-05 05:30:00|0E-14            |76.78900747031288|100     |77.79982571852163|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:13:59.224|7           |2020-08-05 05:30:00|0E-14            |76.37099394549293|100     |76.94631910510188|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:21:43.76 |8           |2020-08-05 05:30:00|0E-14            |77.32601214334609|100     |77.65017757988643|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:30:33.547|9           |2020-08-05 05:30:00|0E-14            |77.11395059665263|100     |77.52985832434904|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:45:54.754|11          |2020-08-05 05:30:00|0E-14            |77.69893211260312|100     |79.18604684163077|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:54:34.696|12          |2020-08-05 05:30:00|0E-14            |75.09529363658093|100     |75.83132049866276|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:02:08.291|13          |2020-08-05 05:30:00|0E-14            |77.76547178321442|100     |79.41345232512326|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:11:36.644|14          |2020-08-05 05:30:00|0E-14            |76.39994032672179|100     |76.83733213626446|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:19:53.959|15          |2020-08-05 05:30:00|0E-14            |79.09882325040374|100     |79.83007081928720|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:29:25.432|16          |2020-08-05 05:30:00|0E-14            |74.72294172166815|100     |76.05085199350985|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:34:40.415|17          |2020-08-05 05:30:00|0E-14            |78.06235033524703|100     |78.36705025855920|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:41:23.633|18          |2020-08-05 05:30:00|0E-14            |78.71683328488820|100     |80.45610125569267|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:50:54.911|19          |2020-08-05 05:30:00|0E-14            |79.17169989748359|100     |80.14798230305898|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 20:57:51,533 :: INFO :: main :: 98 :: Processing eod trade0 + 2) / 2]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 09:09:24.38 |30          |2020-08-05 05:30:00|75.87925515076047|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
only showing top 3 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 20:58:05,740 :: INFO :: main :: 98 :: Processing eod quote0 + 1) / 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |bid_pr           |bid_size|ask_pr           |ask_size|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|76.10016521142818|100     |77.96479759087470|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|75.44372945251948|100     |75.94452858561046|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|78.84798564828422|100     |80.69114407667608|100     |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
only showing top 3 rows

root
 |-- trade_dt: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- event_tm: timestamp (nullable = true)
 |-- event_seq_nb: integer (nullable = true)
 |-- arrival_tm: timestamp (nullable = true)
 |-- bid_pr: decimal(17,14) (nullable = true)
 |-- bid_size: integer (nullable = true)
 |-- ask_pr: decimal(17,14) (nullable = true)
 |-- ask_size: integer (nullable = true)

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
2021-03-23 20:58:12,082 :: INFO :: main :: 98 :: Processing analytical_quote/ 1]
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 20:58:17 WARN HintErrorLogger: Count not find relation 'prev_temp_last_trade' specified in hint 'BROADCAST(prev_temp_last_trade)'.
21/03/23 20:58:19 WARN SparkServiceRPCClient: Syncing Temp Views took 1094 ms
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
path dbfs:/trade_analytical/date=2020-08-06 already exists.;
2021-03-23 20:58:20,442 :: ERROR :: main :: 102 ::  Error encountered while processing analytical_quote
2021-03-23 20:58:20,449 :: INFO :: <module> :: 127 :: Updating the job status in the POSTGRES Table
2021-03-23 20:58:20,459 :: INFO :: <module> :: 130 :: Updating the job status
Job ID Assigned: 6
2021-03-23 20:58:22,181 :: INFO :: get_db_connection :: 99 ::  Successfully connected to postgres DB
2021-03-23 20:58:22,182 :: INFO :: update_job_status :: 43 :: Trying to create table spark_job
2021-03-23 20:58:22,362 :: INFO :: update_job_status :: 53 :: Created Table spark_job for job_id: 6
2021-03-23 20:58:22,363 :: INFO :: update_job_status :: 55 ::  Updating status of the job in the table
2021-03-23 20:58:22,447 :: INFO :: update_job_status :: 64 :: Printing the output of spark job table spark_job
2021-03-23 20:58:22,484 :: INFO :: update_job_status :: 70 :: Data row = (6, analytical_etl, success, 2020-08-06)
2021-03-23 20:58:22,486 :: INFO :: <module> :: 136 :: ALL DONE!


(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>SUCCESS: The process with PID 24228 (child process of PID 24188) has been terminated.
SUCCESS: The process with PID 24188 (child process of PID 23872) has been terminated.
SUCCESS: The process with PID 23872 (child process of PID 2548) has been terminated.
python etldriver.py
<class 'ModuleNotFoundError'> fileure
21/03/23 21:36:10 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 21:36:14 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 21:36:17 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
Traceback (most recent call last):
  File "etldriver.py", line 129, in <module>
    main(**args)
  File "etldriver.py", line 74, in main
    pre_process= Preprocess(spark,spark_context)
NameError: name 'Preprocess' is not defined

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.pyess with PID 23188 (child process of PID 4
Import succeededrminated.
21/03/23 21:38:24 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 21:38:24 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 21:38:28 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
21/03/23 21:38:41 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:34:51.505|1           |2020-08-05 05:30:00|0E-14            |75.30254839137037|100     |75.35916738004924|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:40:52.586|2           |2020-08-05 05:30:00|0E-14            |77.20874619466693|100     |78.90918015646369|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:50:04.681|3           |2020-08-05 05:30:00|0E-14            |77.15973273251218|100     |77.33204694110470|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:57:46.343|4           |2020-08-05 05:30:00|0E-14            |79.29977331004093|100     |80.08399307353596|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:06:50.886|5           |2020-08-05 05:30:00|0E-14            |77.86349512170780|100     |78.30821537434917|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:11:43.839|6           |2020-08-05 05:30:00|0E-14            |78.74799689143143|100     |80.32905299746953|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:17:02.044|7           |2020-08-05 05:30:00|0E-14            |77.16837620945849|100     |77.97598027909252|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:23:58.216|8           |2020-08-05 05:30:00|0E-14            |78.06551496692607|100     |78.80516026628197|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:31:40.057|9           |2020-08-05 05:30:00|0E-14            |76.69653634240801|100     |78.56942375735030|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 06:37:21.581|10          |2020-08-05 05:30:00|79.19488165597565|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:45:27.205|11          |2020-08-05 05:30:00|0E-14            |75.10473622642823|100     |77.09656190920616|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:54:06.198|12          |2020-08-05 05:30:00|0E-14            |74.52147919052219|100     |75.66916329143558|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:03:24.882|13          |2020-08-05 05:30:00|0E-14            |75.16876091805237|100     |76.70697764844876|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:12:54.259|14          |2020-08-05 05:30:00|0E-14            |74.56633254759171|100     |74.62137517521543|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:19:55.013|15          |2020-08-05 05:30:00|0E-14            |74.49803365619901|100     |76.47591167094056|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:27:34.304|16          |2020-08-05 05:30:00|0E-14            |75.22889133048018|100     |76.14368647113133|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:35:18.534|17          |2020-08-05 05:30:00|0E-14            |76.62791946609745|100     |76.99149298587172|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:42:42.976|18          |2020-08-05 05:30:00|0E-14            |77.09466818643507|100     |78.15967343099572|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:51:08.791|19          |2020-08-05 05:30:00|0E-14            |78.33536506091860|100     |79.39139072379258|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 07:56:13.086|20          |2020-08-05 05:30:00|76.49092501585646|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|0E-14            |76.10016521142818|100     |77.96479759087470|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|0E-14            |75.44372945251948|100     |75.94452858561046|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|0E-14            |78.84798564828422|100     |80.69114407667608|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:53:09.803|4           |2020-08-05 05:30:00|0E-14            |74.98336890552693|100     |76.16256530811053|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:00:10.866|5           |2020-08-05 05:30:00|0E-14            |76.71408448666702|100     |77.85512785142082|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:05:24.344|6           |2020-08-05 05:30:00|0E-14            |76.78900747031288|100     |77.79982571852163|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:13:59.224|7           |2020-08-05 05:30:00|0E-14            |76.37099394549293|100     |76.94631910510188|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:21:43.76 |8           |2020-08-05 05:30:00|0E-14            |77.32601214334609|100     |77.65017757988643|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:30:33.547|9           |2020-08-05 05:30:00|0E-14            |77.11395059665263|100     |77.52985832434904|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:45:54.754|11          |2020-08-05 05:30:00|0E-14            |77.69893211260312|100     |79.18604684163077|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:54:34.696|12          |2020-08-05 05:30:00|0E-14            |75.09529363658093|100     |75.83132049866276|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:02:08.291|13          |2020-08-05 05:30:00|0E-14            |77.76547178321442|100     |79.41345232512326|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:11:36.644|14          |2020-08-05 05:30:00|0E-14            |76.39994032672179|100     |76.83733213626446|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:19:53.959|15          |2020-08-05 05:30:00|0E-14            |79.09882325040374|100     |79.83007081928720|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:29:25.432|16          |2020-08-05 05:30:00|0E-14            |74.72294172166815|100     |76.05085199350985|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:34:40.415|17          |2020-08-05 05:30:00|0E-14            |78.06235033524703|100     |78.36705025855920|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:41:23.633|18          |2020-08-05 05:30:00|0E-14            |78.71683328488820|100     |80.45610125569267|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:50:54.911|19          |2020-08-05 05:30:00|0E-14            |79.17169989748359|100     |80.14798230305898|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 09:09:24.38 |30          |2020-08-05 05:30:00|75.87925515076047|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
only showing top 3 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |bid_pr           |bid_size|ask_pr           |ask_size|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|76.10016521142818|100     |77.96479759087470|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|75.44372945251948|100     |75.94452858561046|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|78.84798564828422|100     |80.69114407667608|100     |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
only showing top 3 rows

root
 |-- trade_dt: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- event_tm: timestamp (nullable = true)
 |-- event_seq_nb: integer (nullable = true)
 |-- arrival_tm: timestamp (nullable = true)
 |-- bid_pr: decimal(17,14) (nullable = true)
 |-- bid_size: integer (nullable = true)
 |-- ask_pr: decimal(17,14) (nullable = true)
 |-- ask_size: integer (nullable = true)

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 21:39:31 WARN HintErrorLogger: Count not find relation 'prev_temp_last_trade' specified in hint 'BROADCAST(prev_temp_last_trade)'.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
path dbfs:/trade_analytical/date=2020-08-06 already exists.;
ERROR:root: Error encountered while processing analytical_quote
Job ID Assigned: 9

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>cd PipelineorchestrationSS: The process with PID 18692 (child
The system cannot find the path specified.
SUCCESS: The process with PID 7904 (child process of PID 21164) has been terminated.
(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>1552) has been terminated.
(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>
(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>
(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>cd Pipelineorchestration
The system cannot find the path specified.

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>python etldriver.py
Import succeeded
21/03/23 22:41:33 ERROR Shell: Failed to locate the winutils binary in the hadoop binary path
java.io.IOException: Could not locate executable null\bin\winutils.exe in the Hadoop binaries.
        at org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:382)
        at org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:397)
        at org.apache.hadoop.util.Shell.<clinit>(Shell.java:390)
        at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:80)
        at org.apache.hadoop.security.SecurityUtil.getAuthenticationMethod(SecurityUtil.java:611)
        at org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:262)
        at org.apache.hadoop.security.UserGroupInformation.loginUserFromSubject(UserGroupInformation.java:807)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:777)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:650)
        at org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2680)
        at scala.Option.getOrElse(Option.scala:189)
        at org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2680)
        at org.apache.spark.SecurityManager.<init>(SecurityManager.scala:79)
        at org.apache.spark.deploy.SparkSubmit.secMgr$lzycompute$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.secMgr$1(SparkSubmit.scala:368)
        at org.apache.spark.deploy.SparkSubmit.$anonfun$prepareSubmitEnvironment$8(SparkSubmit.scala:376)
        at scala.Option.map(Option.scala:230)
        at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:376)
        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:871)
        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/03/23 22:41:33 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/23 22:41:34 WARN MetricsSystem: Using default name SparkStatusTracker for source because neither spark.metrics.namespace nor spark.app.id is set.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 22:41:46 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:34:51.505|1           |2020-08-05 05:30:00|0E-14            |75.30254839137037|100     |75.35916738004924|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:40:52.586|2           |2020-08-05 05:30:00|0E-14            |77.20874619466693|100     |78.90918015646369|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:50:04.681|3           |2020-08-05 05:30:00|0E-14            |77.15973273251218|100     |77.33204694110470|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 05:57:46.343|4           |2020-08-05 05:30:00|0E-14            |79.29977331004093|100     |80.08399307353596|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:06:50.886|5           |2020-08-05 05:30:00|0E-14            |77.86349512170780|100     |78.30821537434917|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:11:43.839|6           |2020-08-05 05:30:00|0E-14            |78.74799689143143|100     |80.32905299746953|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:17:02.044|7           |2020-08-05 05:30:00|0E-14            |77.16837620945849|100     |77.97598027909252|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:23:58.216|8           |2020-08-05 05:30:00|0E-14            |78.06551496692607|100     |78.80516026628197|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:31:40.057|9           |2020-08-05 05:30:00|0E-14            |76.69653634240801|100     |78.56942375735030|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 06:37:21.581|10          |2020-08-05 05:30:00|79.19488165597565|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:45:27.205|11          |2020-08-05 05:30:00|0E-14            |75.10473622642823|100     |77.09656190920616|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 06:54:06.198|12          |2020-08-05 05:30:00|0E-14            |74.52147919052219|100     |75.66916329143558|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:03:24.882|13          |2020-08-05 05:30:00|0E-14            |75.16876091805237|100     |76.70697764844876|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:12:54.259|14          |2020-08-05 05:30:00|0E-14            |74.56633254759171|100     |74.62137517521543|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:19:55.013|15          |2020-08-05 05:30:00|0E-14            |74.49803365619901|100     |76.47591167094056|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:27:34.304|16          |2020-08-05 05:30:00|0E-14            |75.22889133048018|100     |76.14368647113133|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:35:18.534|17          |2020-08-05 05:30:00|0E-14            |76.62791946609745|100     |76.99149298587172|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:42:42.976|18          |2020-08-05 05:30:00|0E-14            |77.09466818643507|100     |78.15967343099572|100     |Q        |
|2020-08-05|Q       |SYMA  |NYSE    |2020-08-05 07:51:08.791|19          |2020-08-05 05:30:00|0E-14            |78.33536506091860|100     |79.39139072379258|100     |Q        |
|2020-08-05|T       |SYMA  |NYSE    |2020-08-05 07:56:13.086|20          |2020-08-05 05:30:00|76.49092501585646|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|trade_dt  |rec_type|symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |bid_pr           |bid_size|ask_pr           |ask_size|partition|
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|0E-14            |76.10016521142818|100     |77.96479759087470|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|0E-14            |75.44372945251948|100     |75.94452858561046|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|0E-14            |78.84798564828422|100     |80.69114407667608|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 05:53:09.803|4           |2020-08-05 05:30:00|0E-14            |74.98336890552693|100     |76.16256530811053|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:00:10.866|5           |2020-08-05 05:30:00|0E-14            |76.71408448666702|100     |77.85512785142082|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:05:24.344|6           |2020-08-05 05:30:00|0E-14            |76.78900747031288|100     |77.79982571852163|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:13:59.224|7           |2020-08-05 05:30:00|0E-14            |76.37099394549293|100     |76.94631910510188|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:21:43.76 |8           |2020-08-05 05:30:00|0E-14            |77.32601214334609|100     |77.65017757988643|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:30:33.547|9           |2020-08-05 05:30:00|0E-14            |77.11395059665263|100     |77.52985832434904|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|0E-14            |0       |0E-14            |0       |T        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:45:54.754|11          |2020-08-05 05:30:00|0E-14            |77.69893211260312|100     |79.18604684163077|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 06:54:34.696|12          |2020-08-05 05:30:00|0E-14            |75.09529363658093|100     |75.83132049866276|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:02:08.291|13          |2020-08-05 05:30:00|0E-14            |77.76547178321442|100     |79.41345232512326|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:11:36.644|14          |2020-08-05 05:30:00|0E-14            |76.39994032672179|100     |76.83733213626446|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:19:53.959|15          |2020-08-05 05:30:00|0E-14            |79.09882325040374|100     |79.83007081928720|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:29:25.432|16          |2020-08-05 05:30:00|0E-14            |74.72294172166815|100     |76.05085199350985|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:34:40.415|17          |2020-08-05 05:30:00|0E-14            |78.06235033524703|100     |78.36705025855920|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:41:23.633|18          |2020-08-05 05:30:00|0E-14            |78.71683328488820|100     |80.45610125569267|100     |Q        |
|2020-08-05|Q       |SYMA  |NASDAQ  |2020-08-05 07:50:54.911|19          |2020-08-05 05:30:00|0E-14            |79.17169989748359|100     |80.14798230305898|100     |Q        |
|2020-08-05|T       |SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|0E-14            |0       |0E-14            |0       |T        |
+----------+--------+------+--------+-----------------------+------------+-------------------+-----------------+-----------------+--------+-----------------+--------+---------+
only showing top 20 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |trade_pr         |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 06:38:50.046|10          |2020-08-05 05:30:00|77.77570455205036|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 07:58:33.106|20          |2020-08-05 05:30:00|75.71522806406605|
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 09:09:24.38 |30          |2020-08-05 05:30:00|75.87925515076047|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+
only showing top 3 rows

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|trade_dt  |symbol|exchange|event_tm               |event_seq_nb|arrival_tm         |bid_pr           |bid_size|ask_pr           |ask_size|
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:36:55.284|1           |2020-08-05 05:30:00|76.10016521142818|100     |77.96479759087470|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:42:32.247|2           |2020-08-05 05:30:00|75.44372945251948|100     |75.94452858561046|100     |
|2020-08-05|SYMA  |NASDAQ  |2020-08-05 05:48:06.767|3           |2020-08-05 05:30:00|78.84798564828422|100     |80.69114407667608|100     |
+----------+------+--------+-----------------------+------------+-------------------+-----------------+--------+-----------------+--------+
only showing top 3 rows

root
 |-- trade_dt: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- event_tm: timestamp (nullable = true)
 |-- event_seq_nb: integer (nullable = true)
 |-- arrival_tm: timestamp (nullable = true)
 |-- bid_pr: decimal(17,14) (nullable = true)
 |-- bid_size: integer (nullable = true)
 |-- ask_pr: decimal(17,14) (nullable = true)
 |-- ask_size: integer (nullable = true)

View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
21/03/23 22:42:30 WARN HintErrorLogger: Count not find relation 'prev_temp_last_trade' specified in hint 'BROADCAST(prev_temp_last_trade)'.
View job details at https://adb-79201576775287.7.azuredatabricks.net/?o=79201576775287#/setting/clusters/0323-192449-niece309/sparkUi
path dbfs:/trade_analytical/date=2020-08-06 already exists.;
ERROR:root: Error encountered while processing analytical_quote
Job ID Assigned: 5

(dbconnect) C:\Pipelineorchestration\Pipelineorchestration>SUCCESS: The process with PID 19400 (child process of PID 23972) has been terminated.
SUCCESS: The process with PID 23972 (child process of PID 5880) has been terminated.
SUCCESS: The process with PID 5880 (child process of PID 18028) has been terminated.
